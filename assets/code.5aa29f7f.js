var qe=Object.defineProperty;var Ve=(a,t,e)=>t in a?qe(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e;var P=(a,t,e)=>(Ve(a,typeof t!="symbol"?t+"":t,e),e);import{c as wt,p as Gt,_ as Te,r as mt,w as Ct,o as St,a as Tt,u as ot,b as je,d as fe,n as _t,t as Kt,e as yt,f as Ae,v as Ye,g as Ee,h as ze,i as Xe,j as $e,$ as Ze,k as Zt,l as We,C as Je,F as de,m as Qe,q as Ge,s as _e,x as tn,y as en}from"./index.c85178d9.js";const nn={param:{type:String,default:null},label:{type:String,default:null},labelWidth:{type:String,default:null},labelAlign:{type:String,default:null},labelSplit:{type:String,default:"\uFF1A"},labelTextOnly:{type:Boolean,default:!1}},rn=(a,t)=>{const e=wt(()=>Gt(a.labelTextOnly)),n=wt(()=>{const{label:c}=a,h=String(c);let v=[];return c&&h.trim()&&(v=e.value?[h.trim()]:h.split("|")),v}),r=wt(()=>{const c=n.value[0],h=a.labelSplit;return c?`${c}${h}`:null}),i=wt(()=>{const c=n.value[1],h=a.labelWidth;let v=null;return c&&String(c).trim()&&(v=c),h&&String(h).trim()&&(v=h),t.value&&(v=`calc(${v} - 1.5rem)`),v}),o=wt(()=>{const c=n.value[2],h=a.labelAlign;let v="right";return c&&String(c).trim()&&(v=c),h&&String(h).trim()&&(v=h),v});return{label_:r,labelWidth_:i,labelAlign_:o}};const on=["checked"],sn={class:"inblock"},un=["placeholder","tabindex","type","readonly","disabled","min","max"],an={__name:"Texter",props:{modelValue:{type:[String,Number,Boolean],default:""},disable:{type:Boolean,default:!1},text:{type:String,default:""},default:{type:[String,Number,Boolean],default:""},...nn,disabling:{type:[String,Boolean],default:!1},readonly:{type:[String,Boolean],default:!1},place:{type:[Number,String],default:""},tab:{type:[Number,String],default:0},align:{type:String,default:null},type:{type:String,default:null},min:{type:[Number,String],default:null},max:{type:[Number,String],default:null},focusSwitch:{type:Boolean,default:!1}},emits:["update:modelValue","update:disable","update:value"],setup(a,{emit:t}){const e=a,n=wt(()=>Gt(e.disabling)),r=wt(()=>Gt(e.readonly)),{label_:i,labelWidth_:o,labelAlign_:c}=rn(e,n),h={text:"text",pass:"password",number:"number"},v=wt(()=>h[e.type]||h.text),E=wt(()=>({width:o.value,textAlign:c.value})),B=mt(n.value&&e.modelValue===!1?e.default:e.modelValue),x=mt(n.value?e.modelValue===!1:e.disable);Ct(()=>e.disable,g=>{n.value||(x.value=g)}),Ct(()=>e.modelValue,g=>{n.value?g===!1?x.value=!0:(x.value=!1,B.value=g):B.value=g}),Ct([B,x],([g,m],[T,L])=>{n.value?(g!=T&&t("update:value",g),m!=L&&t("update:disable",m),t("update:modelValue",m===!0?!1:v.value=="number"?~~g:g)):t("update:modelValue",v.value=="number"?~~g:g)});const b=g=>t("update:value",B.value+=g.deltaY>0?-1:1),S=mt(null);return Ct(()=>e.focusSwitch,()=>S.value.focus()),(g,m)=>(St(),Tt("comp-texter",null,[ot(n)?(St(),Tt("p-disabling",{key:0,class:"inblock",checked:ot(je)(!x.value),onClick:m[0]||(m[0]=T=>x.value=!x.value)},null,8,on)):fe("",!0),ot(i)?(St(),Tt("p-label",{key:1,class:"inblock elli",style:_t(ot(E)),onClick:m[1]||(m[1]=T=>ot(n)&&(x.value=!x.value))},Kt(ot(i)),5)):fe("",!0),yt("p-value",sn,[Ae(yt("input",{ref_key:"domInput",ref:S,"onUpdate:modelValue":m[2]||(m[2]=T=>B.value=T),style:_t({textAlign:a.align}),placeholder:a.place,tabindex:a.tab,type:ot(v),readonly:ot(r),disabled:x.value,min:a.min,max:a.max,onMousewheel:m[3]||(m[3]=T=>ot(v)=="number"&&b)},null,44,un),[[Ye,B.value]])])]))}},cn=Te(an,[["__scopeId","data-v-2b01c866"]]);var hn={prefix:"fas",iconName:"clipboard",icon:[384,512,[128203],"f328","M192 0c-41.8 0-77.4 26.7-90.5 64H48C21.5 64 0 85.5 0 112V464c0 26.5 21.5 48 48 48H336c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48H282.5C269.4 26.7 233.8 0 192 0zm0 128c-17.7 0-32-14.3-32-32s14.3-32 32-32s32 14.3 32 32s-14.3 32-32 32zm-80 64H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z"]},ln={prefix:"fas",iconName:"spinner",icon:[512,512,[],"f110","M304 48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zm0 416c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM48 304c26.5 0 48-21.5 48-48s-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48zm464-48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM142.9 437c18.7-18.7 18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zm0-294.2c18.7-18.7 18.7-49.1 0-67.9S93.7 56.2 75 75s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zM369.1 437c18.7 18.7 49.1 18.7 67.9 0s18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9z"]},Ce={exports:{}};/*!
 * clipboard.js v2.0.11
 * https://clipboardjs.com/
 *
 * Licensed MIT Â© Zeno Rocha
 */(function(a,t){(function(n,r){a.exports=r()})(Ee,function(){return function(){var e={686:function(i,o,c){c.d(o,{default:function(){return ct}});var h=c(279),v=c.n(h),E=c(370),B=c.n(E),x=c(817),b=c.n(x);function S(Y){try{return document.execCommand(Y)}catch{return!1}}var g=function(O){var k=b()(O);return S("cut"),k},m=g;function T(Y){var O=document.documentElement.getAttribute("dir")==="rtl",k=document.createElement("textarea");k.style.fontSize="12pt",k.style.border="0",k.style.padding="0",k.style.margin="0",k.style.position="absolute",k.style[O?"right":"left"]="-9999px";var V=window.pageYOffset||document.documentElement.scrollTop;return k.style.top="".concat(V,"px"),k.setAttribute("readonly",""),k.value=Y,k}var L=function(O,k){var V=T(O);k.container.appendChild(V);var U=b()(V);return S("copy"),V.remove(),U},K=function(O){var k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{container:document.body},V="";return typeof O=="string"?V=L(O,k):O instanceof HTMLInputElement&&!["text","search","url","tel","password"].includes(O==null?void 0:O.type)?V=L(O.value,k):(V=b()(O),S("copy")),V},z=K;function $(Y){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?$=function(k){return typeof k}:$=function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k},$(Y)}var _=function(){var O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},k=O.action,V=k===void 0?"copy":k,U=O.container,Z=O.target,st=O.text;if(V!=="copy"&&V!=="cut")throw new Error('Invalid "action" value, use either "copy" or "cut"');if(Z!==void 0)if(Z&&$(Z)==="object"&&Z.nodeType===1){if(V==="copy"&&Z.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if(V==="cut"&&(Z.hasAttribute("readonly")||Z.hasAttribute("disabled")))throw new Error(`Invalid "target" attribute. You can't cut text from elements with "readonly" or "disabled" attributes`)}else throw new Error('Invalid "target" value, use a valid Element');if(st)return z(st,{container:U});if(Z)return V==="cut"?m(Z):z(Z,{container:U})},q=_;function Q(Y){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Q=function(k){return typeof k}:Q=function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k},Q(Y)}function G(Y,O){if(!(Y instanceof O))throw new TypeError("Cannot call a class as a function")}function et(Y,O){for(var k=0;k<O.length;k++){var V=O[k];V.enumerable=V.enumerable||!1,V.configurable=!0,"value"in V&&(V.writable=!0),Object.defineProperty(Y,V.key,V)}}function at(Y,O,k){return O&&et(Y.prototype,O),k&&et(Y,k),Y}function Vt(Y,O){if(typeof O!="function"&&O!==null)throw new TypeError("Super expression must either be null or a function");Y.prototype=Object.create(O&&O.prototype,{constructor:{value:Y,writable:!0,configurable:!0}}),O&&At(Y,O)}function At(Y,O){return At=Object.setPrototypeOf||function(V,U){return V.__proto__=U,V},At(Y,O)}function jt(Y){var O=Bt();return function(){var V=Et(Y),U;if(O){var Z=Et(this).constructor;U=Reflect.construct(V,arguments,Z)}else U=V.apply(this,arguments);return Yt(this,U)}}function Yt(Y,O){return O&&(Q(O)==="object"||typeof O=="function")?O:Rt(Y)}function Rt(Y){if(Y===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Y}function Bt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function Et(Y){return Et=Object.setPrototypeOf?Object.getPrototypeOf:function(k){return k.__proto__||Object.getPrototypeOf(k)},Et(Y)}function w(Y,O){var k="data-clipboard-".concat(Y);if(!!O.hasAttribute(k))return O.getAttribute(k)}var Mt=function(Y){Vt(k,Y);var O=jt(k);function k(V,U){var Z;return G(this,k),Z=O.call(this),Z.resolveOptions(U),Z.listenClick(V),Z}return at(k,[{key:"resolveOptions",value:function(){var U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.action=typeof U.action=="function"?U.action:this.defaultAction,this.target=typeof U.target=="function"?U.target:this.defaultTarget,this.text=typeof U.text=="function"?U.text:this.defaultText,this.container=Q(U.container)==="object"?U.container:document.body}},{key:"listenClick",value:function(U){var Z=this;this.listener=B()(U,"click",function(st){return Z.onClick(st)})}},{key:"onClick",value:function(U){var Z=U.delegateTarget||U.currentTarget,st=this.action(Z)||"copy",pt=q({action:st,container:this.container,target:this.target(Z),text:this.text(Z)});this.emit(pt?"success":"error",{action:st,text:pt,trigger:Z,clearSelection:function(){Z&&Z.focus(),window.getSelection().removeAllRanges()}})}},{key:"defaultAction",value:function(U){return w("action",U)}},{key:"defaultTarget",value:function(U){var Z=w("target",U);if(Z)return document.querySelector(Z)}},{key:"defaultText",value:function(U){return w("text",U)}},{key:"destroy",value:function(){this.listener.destroy()}}],[{key:"copy",value:function(U){var Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{container:document.body};return z(U,Z)}},{key:"cut",value:function(U){return m(U)}},{key:"isSupported",value:function(){var U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["copy","cut"],Z=typeof U=="string"?[U]:U,st=!!document.queryCommandSupported;return Z.forEach(function(pt){st=st&&!!document.queryCommandSupported(pt)}),st}}]),k}(v()),ct=Mt},828:function(i){var o=9;if(typeof Element<"u"&&!Element.prototype.matches){var c=Element.prototype;c.matches=c.matchesSelector||c.mozMatchesSelector||c.msMatchesSelector||c.oMatchesSelector||c.webkitMatchesSelector}function h(v,E){for(;v&&v.nodeType!==o;){if(typeof v.matches=="function"&&v.matches(E))return v;v=v.parentNode}}i.exports=h},438:function(i,o,c){var h=c(828);function v(x,b,S,g,m){var T=B.apply(this,arguments);return x.addEventListener(S,T,m),{destroy:function(){x.removeEventListener(S,T,m)}}}function E(x,b,S,g,m){return typeof x.addEventListener=="function"?v.apply(null,arguments):typeof S=="function"?v.bind(null,document).apply(null,arguments):(typeof x=="string"&&(x=document.querySelectorAll(x)),Array.prototype.map.call(x,function(T){return v(T,b,S,g,m)}))}function B(x,b,S,g){return function(m){m.delegateTarget=h(m.target,b),m.delegateTarget&&g.call(x,m)}}i.exports=E},879:function(i,o){o.node=function(c){return c!==void 0&&c instanceof HTMLElement&&c.nodeType===1},o.nodeList=function(c){var h=Object.prototype.toString.call(c);return c!==void 0&&(h==="[object NodeList]"||h==="[object HTMLCollection]")&&"length"in c&&(c.length===0||o.node(c[0]))},o.string=function(c){return typeof c=="string"||c instanceof String},o.fn=function(c){var h=Object.prototype.toString.call(c);return h==="[object Function]"}},370:function(i,o,c){var h=c(879),v=c(438);function E(S,g,m){if(!S&&!g&&!m)throw new Error("Missing required arguments");if(!h.string(g))throw new TypeError("Second argument must be a String");if(!h.fn(m))throw new TypeError("Third argument must be a Function");if(h.node(S))return B(S,g,m);if(h.nodeList(S))return x(S,g,m);if(h.string(S))return b(S,g,m);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}function B(S,g,m){return S.addEventListener(g,m),{destroy:function(){S.removeEventListener(g,m)}}}function x(S,g,m){return Array.prototype.forEach.call(S,function(T){T.addEventListener(g,m)}),{destroy:function(){Array.prototype.forEach.call(S,function(T){T.removeEventListener(g,m)})}}}function b(S,g,m){return v(document.body,S,g,m)}i.exports=E},817:function(i){function o(c){var h;if(c.nodeName==="SELECT")c.focus(),h=c.value;else if(c.nodeName==="INPUT"||c.nodeName==="TEXTAREA"){var v=c.hasAttribute("readonly");v||c.setAttribute("readonly",""),c.select(),c.setSelectionRange(0,c.value.length),v||c.removeAttribute("readonly"),h=c.value}else{c.hasAttribute("contenteditable")&&c.focus();var E=window.getSelection(),B=document.createRange();B.selectNodeContents(c),E.removeAllRanges(),E.addRange(B),h=E.toString()}return h}i.exports=o},279:function(i){function o(){}o.prototype={on:function(c,h,v){var E=this.e||(this.e={});return(E[c]||(E[c]=[])).push({fn:h,ctx:v}),this},once:function(c,h,v){var E=this;function B(){E.off(c,B),h.apply(v,arguments)}return B._=h,this.on(c,B,v)},emit:function(c){var h=[].slice.call(arguments,1),v=((this.e||(this.e={}))[c]||[]).slice(),E=0,B=v.length;for(E;E<B;E++)v[E].fn.apply(v[E].ctx,h);return this},off:function(c,h){var v=this.e||(this.e={}),E=v[c],B=[];if(E&&h)for(var x=0,b=E.length;x<b;x++)E[x].fn!==h&&E[x].fn._!==h&&B.push(E[x]);return B.length?v[c]=B:delete v[c],this}},i.exports=o,i.exports.TinyEmitter=o}},n={};function r(i){if(n[i])return n[i].exports;var o=n[i]={exports:{}};return e[i](o,o.exports,r),o.exports}return function(){r.n=function(i){var o=i&&i.__esModule?function(){return i.default}:function(){return i};return r.d(o,{a:o}),o}}(),function(){r.d=function(i,o){for(var c in o)r.o(o,c)&&!r.o(i,c)&&Object.defineProperty(i,c,{enumerable:!0,get:o[c]})}}(),function(){r.o=function(i,o){return Object.prototype.hasOwnProperty.call(i,o)}}(),r(686)}().default})})(Ce);const fn=ze(Ce.exports),F={Sbox:[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],ShiftRowTab:[0,5,10,15,4,9,14,3,8,13,2,7,12,1,6,11],Sbox_Inv:new Array(256),ShiftRowTab_Inv:new Array(16),xtime:new Array(256),Init(){for(let a=0;a<256;a++)this.Sbox_Inv[this.Sbox[a]]=a;for(let a=0;a<16;a++)this.ShiftRowTab_Inv[this.ShiftRowTab[a]]=a;for(let a=0;a<128;a++)this.xtime[a]=a<<1,this.xtime[128+a]=a<<1^27},Done(){this.Sbox_Inv.length=0,this.Sbox_Inv.length=256,this.ShiftRowTab_Inv.length=0,this.ShiftRowTab_Inv.length=16,this.xtime.length=0,this.xtime.length=256},ExpandKey(a){const t=a.length;let e,n=1;switch(t){case 16:e=176;break;case 24:e=208;break;case 32:e=240;break;default:throw"my.ExpandKey: Only key lengths of 16, 24 or 32 bytes allowed!"}for(let r=t;r<e;r+=4){let i=a.slice(r-4,r);r%t==0?(i=[F.Sbox[i[1]]^n,F.Sbox[i[2]],F.Sbox[i[3]],F.Sbox[i[0]]],(n<<=1)>=256&&(n^=283)):t>24&&r%t==16&&(i=[F.Sbox[i[0]],F.Sbox[i[1]],F.Sbox[i[2]],F.Sbox[i[3]]]);for(let o=0;o<4;o++)a[r+o]=a[r+o-t]^i[o]}},Encrypt(a,t){const e=t.length;let n;for(F.AddRoundKey(a,t.slice(0,16)),n=16;n<e-16;n+=16)F.SubBytes(a,F.Sbox),F.ShiftRows(a,F.ShiftRowTab),F.MixColumns(a),F.AddRoundKey(a,t.slice(n,n+16));F.SubBytes(a,F.Sbox),F.ShiftRows(a,F.ShiftRowTab),F.AddRoundKey(a,t.slice(n,e))},Decrypt(a,t){const e=t.length;F.AddRoundKey(a,t.slice(e-16,e)),F.ShiftRows(a,F.ShiftRowTab_Inv),F.SubBytes(a,F.Sbox_Inv);for(let n=e-32;n>=16;n-=16)F.AddRoundKey(a,t.slice(n,n+16)),F.MixColumns_Inv(a),F.ShiftRows(a,F.ShiftRowTab_Inv),F.SubBytes(a,F.Sbox_Inv);F.AddRoundKey(a,t.slice(0,16))},SubBytes(a,t){for(let e=0;e<16;e++)a[e]=t[a[e]]},AddRoundKey(a,t){for(let e=0;e<16;e++)a[e]^=t[e]},ShiftRows(a,t){const e=new Array().concat(a);for(let n=0;n<16;n++)a[n]=e[t[n]]},MixColumns(a){for(let t=0;t<16;t+=4){const e=a[t+0],n=a[t+1],r=a[t+2],i=a[t+3],o=e^n^r^i;a[t+0]^=o^F.xtime[e^n],a[t+1]^=o^F.xtime[n^r],a[t+2]^=o^F.xtime[r^i],a[t+3]^=o^F.xtime[i^e]}},MixColumns_Inv(a){for(let t=0;t<16;t+=4){const e=a[t+0],n=a[t+1],r=a[t+2],i=a[t+3],o=e^n^r^i,c=F.xtime[o],h=F.xtime[F.xtime[c^e^r]]^o,v=F.xtime[F.xtime[c^n^i]]^o;a[t+0]^=h^F.xtime[e^n],a[t+1]^=v^F.xtime[n^r],a[t+2]^=h^F.xtime[r^i],a[t+3]^=v^F.xtime[i^e]}}},Ut=[],xe=Math.pow(2,52),dn=2*xe,pn=Math.pow(256,6),Pt={seedrandom(a,t=!1){const e=[];a=te(Ie(t?[a,Ut]:arguments.length?a:[new Date().getTime(),Ut],3),e);const n=new mn(e);return te(n.S,Ut),Pt.random=function(){let r=n.g(6),i=pn,o=0;for(;r<xe;)r=256*(r+o),i*=256,o=n.g(1);for(;r>=dn;)r/=2,i/=2,o>>>=1;return(r+o)/i},a},random:function(){return Math.random()}};class mn{constructor(t){P(this,"i",0);P(this,"j",0);P(this,"S",[]);P(this,"c",[]);let e,n,r=t.length,i=0,o=0;for(r||(t=[r++]);i<256;)this.S[i]=i++;for(i=0;i<256;i++)e=this.S[i],o=gt(o+e+t[i%r]),n=this.S[o],this.S[i]=n,this.S[o]=e;this.g(256)}g(t){const e=this.S;let n=gt(this.i+1),r=e[n],i=gt(this.j+r),o=e[i];e[n]=o,e[i]=r;let c=e[gt(r+o)];for(;--t;)n=gt(n+1),r=e[n],i=gt(i+r),o=e[i],e[n]=o,e[i]=r,c=256*c+e[gt(r+o)];return this.i=n,this.j=i,c}}function Ie(a,t){const e=[],n=typeof a;if(t&&n==="object"){for(const r in a)if(r.indexOf("S")<5)try{e.push(Ie(a[r],t-1))}catch(i){console.error(i)}}return e.length?e:a+(n!=="string"?"\0":"")}function te(a,t){const e=a+"";let n=0;for(let i=0;i<e.length;i++)t[gt(i)]=gt((n^=19*t[gt(i)])+e.charCodeAt(i));let r="";return t.forEach(i=>r+=String.fromCharCode(i)),r}function gt(a){return 255&a}te(Math.random(),Ut);class gn{nextBytes(t){for(let e=0;e<t.length;e++)t[e]=Math.floor(256*Pt.random())}}class wn{constructor(){P(this,"i",0);P(this,"j",0);P(this,"S",[])}init(t){let e,n,r;for(e=0;e<256;++e)this.S[e]=e;for(n=0,e=0;e<256;++e)n=n+this.S[e]+t[e%t.length]&255,r=this.S[e],this.S[e]=this.S[n],this.S[n]=r;this.i=0,this.j=0}next(){this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255;const t=this.S[this.i];return this.S[this.i]=this.S[this.j],this.S[this.j]=t,this.S[t+this.S[this.i]&255]}}let Ot,it,dt=[];function Ne(){var a;a=new Date().getTime(),dt[it++]^=255&a,dt[it++]^=a>>8&255,dt[it++]^=a>>16&255,dt[it++]^=a>>24&255,it>=256&&(it-=256)}if(!dt){let a;for(dt=[],it=0;it<256;)a=Math.floor(65536*Math.random()),dt[it++]=a>>>8,dt[it++]=255&a;it=0,Ne()}function vn(){if(!Ot){for(Ne(),Ot=new wn,Ot.init(dt),it=0;it<dt.length;++it)dt[it]=0;it=0}return Ot.next()}class ee{nextBytes(t){let e;for(e=0;e<t.length;++e)t[e]=vn()}}const yn=(a,t)=>a&t,Wt=(a,t)=>a|t,pe=(a,t)=>a^t,me=(a,t)=>a&~t,y=class{constructor(t,e,n){P(this,"s",0);P(this,"t",0);t&&(typeof t=="number"?e?this.fromNumber(t,e,n):this.fromInt(t):this.fromString(t,e||256))}am(t,e,n,r,i,o){const c=32767&e,h=e>>15;for(;--o>=0;){let v=32767&this[t];const E=this[t++]>>15,B=h*v+E*c;v=c*v+((32767&B)<<15)+n[r]+(1073741823&i),i=(v>>>30)+(B>>>15)+h*E+(i>>>30),n[r++]=1073741823&v}return i}copyTo(t){for(let e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t,t.s=this.s}fromInt(t){this.t=1,this.s=t<0?-1:0,t>0?this[0]=t:t<-1?this[0]=t+y.DV:this.t=0}fromString(t,e){let n;if(e===16)n=4;else if(e===8)n=3;else if(e===256)n=8;else if(e===2)n=1;else if(e===32)n=5;else{if(e!==4)return void this.fromRadix(t,e);n=2}this.t=0,this.s=0;let r=t.length,i=!1,o=0;for(;--r>=0;){const c=n===8?t[r]:ge(t,r);c<0?t.charAt(r)==="-"&&(i=!0):(i=!1,o===0?this[this.t++]=c:o+n>y.DB?(this[this.t-1]|=(c&(1<<y.DB-o)-1)<<o,this[this.t++]=c>>y.DB-o):this[this.t-1]|=c<<o,o+=n,o>=y.DB&&(o-=y.DB))}n===8&&(128&t[0])!=0&&(this.s=-1,o>0&&(this[this.t-1]|=(1<<y.DB-o)-1<<o)),this.clamp(),i&&y.ZERO.subTo(this,this)}clamp(){const t=this.s&y.DM;for(;this.t>0&&this[this.t-1]===t;)--this.t}toString(t=16){if(this.s<0)return"-"+this.negate().toString(t);let e;if(t===16)e=4;else if(t===8)e=3;else if(t===2)e=1;else if(t===32)e=5;else if(t===64)e=6;else{if(t!==4)return this.toRadix(t);e=2}const n=(1<<e)-1;let r,i=!1,o="",c=this.t,h=y.DB-c*y.DB%e;if(c-- >0)for(h<y.DB&&(r=this[c]>>h)>0&&(i=!0,o=bt(r));c>=0;)h<e?(r=(this[c]&(1<<h)-1)<<e-h,r|=this[--c]>>(h+=y.DB-e)):(r=this[c]>>(h-=e)&n,h<=0&&(h+=y.DB,--c)),r>0&&(i=!0),i&&(o+=bt(r));return i?o:"0"}negate(){const t=new y;return y.ZERO.subTo(this,t),t}abs(){return this.s<0?this.negate():this}compareTo(t){let e=this.s-t.s;if(e!==0)return e;let n=this.t;if(e=n-t.t,e!==0)return e;for(;--n>=0;)if((e=this[n]-t[n])!=0)return e;return 0}bitLength(){return this.t<=0?0:y.DB*(this.t-1)+Ht(this[this.t-1]^this.s&y.DM)}dlShiftTo(t,e){let n;for(n=this.t-1;n>=0;--n)e[n+t]=this[n];for(n=t-1;n>=0;--n)e[n]=0;e.t=this.t+t,e.s=this.s}drShiftTo(t,e){for(let n=t;n<this.t;++n)e[n-t]=this[n];e.t=Math.max(this.t-t,0),e.s=this.s}lShiftTo(t,e){const n=t%y.DB,r=y.DB-n,i=(1<<r)-1,o=Math.floor(t/y.DB);let c,h=this.s<<n&y.DM;for(c=this.t-1;c>=0;--c)e[c+o+1]=this[c]>>r|h,h=(this[c]&i)<<n;for(c=o-1;c>=0;--c)e[c]=0;e[o]=h,e.t=this.t+o+1,e.s=this.s,e.clamp()}rShiftTo(t,e){e.s=this.s;const n=Math.floor(t/y.DB);if(n>=this.t)return void(e.t=0);const r=t%y.DB,i=y.DB-r,o=(1<<r)-1;e[0]=this[n]>>r;for(let c=n+1;c<this.t;++c)e[c-n-1]|=(this[c]&o)<<i,e[c-n]=this[c]>>r;r>0&&(e[this.t-n-1]|=(this.s&o)<<i),e.t=this.t-n,e.clamp()}subTo(t,e){const n=Math.min(t.t,this.t);let r=0,i=0;for(;r<n;)i+=this[r]-t[r],e[r++]=i&y.DM,i>>=y.DB;if(t.t<this.t){for(i-=t.s;r<this.t;)i+=this[r],e[r++]=i&y.DM,i>>=y.DB;i+=this.s}else{for(i+=this.s;r<t.t;)i-=t[r],e[r++]=i&y.DM,i>>=y.DB;i-=t.s}e.s=i<0?-1:0,i<-1?e[r++]=y.DV+i:i>0&&(e[r++]=i),e.t=r,e.clamp()}multiplyTo(t,e){const n=this.abs(),r=t.abs();let i=n.t;for(e.t=i+r.t;--i>=0;)e[i]=0;for(i=0;i<r.t;++i)e[i+n.t]=n.am(0,r[i],e,i,0,n.t);e.s=0,e.clamp(),this.s!==t.s&&y.ZERO.subTo(e,e)}squareTo(t){const e=this.abs();let n=t.t=2*e.t;for(;--n>=0;)t[n]=0;for(n=0;n<e.t-1;++n){const r=e.am(n,e[n],t,2*n,0,1);(t[n+e.t]+=e.am(n+1,2*e[n],t,2*n+1,r,e.t-n-1))>=y.DV&&(t[n+e.t]-=y.DV,t[n+e.t+1]=1)}t.t>0&&(t[t.t-1]+=e.am(n,e[n],t,2*n,0,1)),t.s=0,t.clamp()}divRemTo(t,e,n){const r=t.abs();if(r.t<=0)return;const i=this.abs();if(i.t<r.t)return e&&e.fromInt(0),void(n&&this.copyTo(n));n||(n=new y);const o=new y,c=this.s,h=t.s,v=y.DB-Ht(r[r.t-1]);v>0?(r.lShiftTo(v,o),i.lShiftTo(v,n)):(r.copyTo(o),i.copyTo(n));const E=o.t,B=o[E-1];if(B===0)return;const x=B*(1<<y.F1)+(E>1?o[E-2]>>y.F2:0),b=y.FV/x,S=(1<<y.F1)/x,g=1<<y.F2,m=e||new y;let T=n.t,L=T-E;for(o.dlShiftTo(L,m),n.compareTo(m)>=0&&(n[n.t++]=1,n.subTo(m,n)),y.ONE.dlShiftTo(E,m),m.subTo(o,o);o.t<E;)o[o.t++]=0;for(;--L>=0;){let K=n[--T]===B?y.DM:Math.floor(n[T]*b+(n[T-1]+g)*S);if((n[T]+=o.am(0,K,n,L,0,E))<K)for(o.dlShiftTo(L,m),n.subTo(m,n);n[T]<--K;)n.subTo(m,n)}e&&(n.drShiftTo(E,e),c!==h&&y.ZERO.subTo(e,e)),n.t=E,n.clamp(),v>0&&n.rShiftTo(v,n),c<0&&y.ZERO.subTo(n,n)}mod(t){const e=new y;return this.abs().divRemTo(t,void 0,e),this.s<0&&e.compareTo(y.ZERO)>0&&t.subTo(e,e),e}invDigit(){if(this.t<1)return 0;const t=this[0];if((1&t)==0)return 0;let e=3&t;return e=e*(2-(15&t)*e)&15,e=e*(2-(255&t)*e)&255,e=e*(2-((65535&t)*e&65535))&65535,e=e*(2-t*e%y.DV)%y.DV,e>0?y.DV-e:-e}isEven(){return(this.t>0?1&this[0]:this.s)===0}exp(t,e){if(t>4294967295||t<1)return y.ONE;const n=e.convert(this);let r=new y,i=new y,o=Ht(t)-1;for(n.copyTo(r);--o>=0;)if(e.sqrTo(r,i),(t&1<<o)>0)e.mulTo(i,n,r);else{const c=r;r=i,i=c}return e.revert(r)}modPowInt(t,e){let n;return n=t<256||e.isEven()?new we(e):new ve(e),this.exp(t,n)}clone(){const t=new y;return this.copyTo(t),t}intValue(){if(this.s<0){if(this.t===1)return this[0]-y.DV;if(this.t===0)return-1}else{if(this.t===1)return this[0];if(this.t===0)return 0}return(this[1]&(1<<32-y.DB)-1)<<y.DB|this[0]}byteValue(){return this.t===0?this.s:this[0]<<24>>24}shortValue(){return this.t===0?this.s:this[0]<<16>>16}chunkSize(t){return Math.floor(Math.LN2*y.DB/Math.log(t))}signum(){return this.s<0?-1:this.t<=0||this.t===1&&this[0]<=0?0:1}toRadix(t){if(t||(t=10),this.signum()===0||t<2||t>36)return"0";const e=this.chunkSize(t),n=Math.pow(t,e),r=new y(n),i=new y,o=new y;let c="";for(this.divRemTo(r,i,o);i.signum()>0;)c=(n+o.intValue()).toString(t).substr(1)+c,i.divRemTo(r,i,o);return o.intValue().toString(t)+c}fromRadix(t,e){this.fromInt(0),e||(e=10);const n=this.chunkSize(e),r=Math.pow(e,n);let i=!1,o=0,c=0;for(let h=0;h<t.length;++h){const v=ge(t,h);v<0?t.charAt(h)==="-"&&this.signum()===0&&(i=!0):(c=e*c+v,++o>=n&&(this.dMultiply(r),this.dAddOffset(c,0),o=0,c=0))}o>0&&(this.dMultiply(Math.pow(e,o)),this.dAddOffset(c,0)),i&&y.ZERO.subTo(this,this)}fromNumber(t,e,n){if(typeof e=="number")if(t<2)this.fromInt(1);else for(this.fromNumber(t,n),this.testBit(t-1)||this.bitwiseTo(y.ONE.shiftLeft(t-1),Wt,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(y.ONE.shiftLeft(t-1),this);else{const r=[],i=7&t;r.length=1+(t>>3),e.nextBytes(r),i>0?r[0]&=(1<<i)-1:r[0]=0,this.fromString(r,256)}}toByteArray(){const t=[];let e=this.t;t[0]=this.s;let n,r=y.DB-e*y.DB%8,i=0;if(e-- >0)for(r<y.DB&&(n=this[e]>>r)!=(this.s&y.DM)>>r&&(t[i++]=n|this.s<<y.DB-r);e>=0;)r<8?(n=(this[e]&(1<<r)-1)<<8-r,n|=this[--e]>>(r+=y.DB-8)):(n=this[e]>>(r-=8)&255,r<=0&&(r+=y.DB,--e)),(128&n)!=0&&(n|=-256),i===0&&(128&this.s)!=(128&n)&&++i,(i>0||n!==this.s)&&(t[i++]=n);return t}equals(t){return this.compareTo(t)===0}min(t){return this.compareTo(t)<0?this:t}max(t){return this.compareTo(t)>0?this:t}bitwiseTo(t,e,n){const r=Math.min(t.t,this.t);let i;for(let o=0;o<r;++o)n[o]=e(this[o],t[o]);if(t.t<this.t){i=t.s&y.DM;for(let o=r;o<this.t;++o)n[o]=e(this[o],i);n.t=this.t}else{i=this.s&y.DM;for(let o=r;o<t.t;++o)n[o]=e(i,t[o]);n.t=t.t}n.s=e(this.s,t.s),n.clamp()}and(t){const e=new y;return this.bitwiseTo(t,yn,e),e}or(t){const e=new y;return this.bitwiseTo(t,Wt,e),e}xor(t){const e=new y;return this.bitwiseTo(t,pe,e),e}andNot(t){const e=new y;return this.bitwiseTo(t,me,e),e}not(){const t=new y;for(let e=0;e<this.t;++e)t[e]=y.DM&~this[e];return t.t=this.t,t.s=~this.s,t}shiftLeft(t){const e=new y;return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}shiftRight(t){const e=new y;return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}getLowestSetBit(){for(let t=0;t<this.t;++t)if(this[t]!==0)return t*y.DB+bn(this[t]);return this.s<0?this.t*y.DB:-1}bitCount(){const t=this.s&y.DM;let e=0;for(let n=0;n<this.t;++n)e+=Sn(this[n]^t);return e}testBit(t){const e=Math.floor(t/y.DB);return e>=this.t?this.s!==0:(this[e]&1<<t%y.DB)!=0}changeBit(t,e){const n=y.ONE.shiftLeft(t);return this.bitwiseTo(n,e,n),n}setBit(t){return this.changeBit(t,Wt)}clearBit(t){return this.changeBit(t,me)}flipBit(t){return this.changeBit(t,pe)}addTo(t,e){const n=Math.min(t.t,this.t);let r=0,i=0;for(;r<n;)i+=this[r]+t[r],e[r++]=i&y.DM,i>>=y.DB;if(t.t<this.t){for(i+=t.s;r<this.t;)i+=this[r],e[r++]=i&y.DM,i>>=y.DB;i+=this.s}else{for(i+=this.s;r<t.t;)i+=t[r],e[r++]=i&y.DM,i>>=y.DB;i+=t.s}e.s=i<0?-1:0,i>0?e[r++]=i:i<-1&&(e[r++]=y.DV+i),e.t=r,e.clamp()}add(t){const e=new y;return this.addTo(t,e),e}subtract(t){const e=new y;return this.subTo(t,e),e}multiply(t){const e=new y;return this.multiplyTo(t,e),e}square(){const t=new y;return this.squareTo(t),t}divide(t){const e=new y;return this.divRemTo(t,e,void 0),e}remainder(t){const e=new y;return this.divRemTo(t,void 0,e),e}divideAndRemainder(t){const e=new y,n=new y;return this.divRemTo(t,e,n),[e,n]}dMultiply(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}dAddOffset(t,e){if(t!==0){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=t;this[e]>=y.DV;)this[e]-=y.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}}pow(t){return this.exp(t,new Tn)}multiplyLowerTo(t,e,n){let r,i=Math.min(this.t+t.t,e);for(n.s=0,n.t=i;i>0;)n[--i]=0;for(r=n.t-this.t;i<r;++i)n[i+this.t]=this.am(0,t[i],n,i,0,this.t);for(r=Math.min(t.t,e);i<r;++i)this.am(0,t[i],n,i,0,e-i);n.clamp()}multiplyUpperTo(t,e,n){--e;let r=n.t=this.t+t.t-e;for(n.s=0;--r>=0;)n[r]=0;for(r=Math.max(e-this.t,0);r<t.t;++r)n[this.t+r-e]=this.am(e-r,t[r],n,0,0,this.t+r-e);n.clamp(),n.drShiftTo(1,n)}modPow(t,e){let n,r,i=t.bitLength(),o=new y(1);if(i<=0)return o;n=i<18?1:i<48?3:i<144?4:i<768?5:6,r=i<8?new we(e):e.isEven()?new An(e):new ve(e);const c=[],h=n-1,v=(1<<n)-1;let E=3;if(c[1]=r.convert(this),n>1){const m=new y;for(r.sqrTo(c[1],m);E<=v;)c[E]=new y,r.mulTo(m,c[E-2],c[E]),E+=2}let B,x,b=t.t-1,S=!0,g=new y;for(i=Ht(t[b])-1;b>=0;){for(i>=h?B=t[b]>>i-h&v:(B=(t[b]&(1<<i+1)-1)<<h-i,b>0&&(B|=t[b-1]>>y.DB+i-h)),E=n;(1&B)==0;)B>>=1,--E;if((i-=E)<0&&(i+=y.DB,--b),S)c[B].copyTo(o),S=!1;else{for(;E>1;)r.sqrTo(o,g),r.sqrTo(g,o),E-=2;E>0?r.sqrTo(o,g):(x=o,o=g,g=x),r.mulTo(g,c[B],o)}for(;b>=0&&(t[b]&1<<i)==0;)r.sqrTo(o,g),x=o,o=g,g=x,--i<0&&(i=y.DB-1,--b)}return r.revert(o)}gcd(t){let e=this.s<0?this.negate():this.clone(),n=t.s<0?t.negate():t.clone();if(e.compareTo(n)<0){const o=e;e=n,n=o}let r=e.getLowestSetBit(),i=n.getLowestSetBit();if(i<0)return e;for(r<i&&(i=r),i>0&&(e.rShiftTo(i,e),n.rShiftTo(i,n));e.signum()>0;)(r=e.getLowestSetBit())>0&&e.rShiftTo(r,e),(r=n.getLowestSetBit())>0&&n.rShiftTo(r,n),e.compareTo(n)>=0?(e.subTo(n,e),e.rShiftTo(1,e)):(n.subTo(e,n),n.rShiftTo(1,n));return i>0&&n.lShiftTo(i,n),n}modInt(t){if(t<=0)return 0;const e=y.DV%t;let n=this.s<0?t-1:0;if(this.t>0)if(e===0)n=this[0]%t;else for(let r=this.t-1;r>=0;--r)n=(e*n+this[r])%t;return n}modInverse(t){const e=t.isEven();if(this.isEven()&&e||t.signum()===0)return y.ZERO;const n=t.clone(),r=this.clone(),i=new y(1),o=new y(0),c=new y(0),h=new y(1);for(;n.signum()!==0;){for(;n.isEven();)n.rShiftTo(1,n),e?(i.isEven()&&o.isEven()||(i.addTo(this,i),o.subTo(t,o)),i.rShiftTo(1,i)):o.isEven()||o.subTo(t,o),o.rShiftTo(1,o);for(;r.isEven();)r.rShiftTo(1,r),e?(c.isEven()&&h.isEven()||(c.addTo(this,c),h.subTo(t,h)),c.rShiftTo(1,c)):h.isEven()||h.subTo(t,h),h.rShiftTo(1,h);n.compareTo(r)>=0?(n.subTo(r,n),e&&i.subTo(c,i),o.subTo(h,o)):(r.subTo(n,r),e&&c.subTo(i,c),h.subTo(o,h))}return r.compareTo(y.ONE)!==0?y.ZERO:h.compareTo(t)>=0?h.subtract(t):h.signum()<0?(h.addTo(t,h),h.signum()<0?h.add(t):h):h}isProbablePrime(t){const e=this.abs();let n;if(e.t===1&&e[0]<=y.lowprimes[y.lowprimes.length-1]){for(n=0;n<y.lowprimes.length;++n)if(e[0]===y.lowprimes[n])return!0;return!1}if(e.isEven())return!1;for(n=1;n<y.lowprimes.length;){let r=y.lowprimes[n],i=n+1;for(;i<y.lowprimes.length&&r<y.lplim;)r*=y.lowprimes[i++];for(r=e.modInt(r);n<i;)if(r%y.lowprimes[n++]==0)return!1}return e.millerRabin(t)}millerRabin(t){const e=this.subtract(y.ONE),n=e.getLowestSetBit();if(n<=0)return!1;const r=e.shiftRight(n);(t=t+1>>1)>y.lowprimes.length&&(t=y.lowprimes.length);const i=new y;for(let o=0;o<t;++o){i.fromInt(y.lowprimes[Math.floor(Pt.random()*y.lowprimes.length)]);let c=i.modPow(r,this);if(c.compareTo(y.ONE)!==0&&c.compareTo(e)!==0){let h=1;for(;h++<n&&c.compareTo(e)!==0;)if(c=c.modPowInt(2,this),c.compareTo(y.ONE)===0)return!1;if(c.compareTo(e)!==0)return!1}}return!0}};let j=y;P(j,"DB",30),P(j,"DM",(1<<30)-1),P(j,"DV",1<<30),P(j,"FV",Math.pow(2,52)),P(j,"F1",22),P(j,"F2",8),P(j,"ZERO",new y(0)),P(j,"ONE",new y(1)),P(j,"lowprimes",[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997]),P(j,"lplim",(1<<26)/y.lowprimes[y.lowprimes.length-1]);const qt=[];let xt,lt;for(xt="0".charCodeAt(0),lt=0;lt<=9;++lt)qt[xt++]=lt;for(xt="a".charCodeAt(0),lt=10;lt<36;++lt)qt[xt++]=lt;for(xt="A".charCodeAt(0),lt=10;lt<36;++lt)qt[xt++]=lt;function bt(a){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(a)}function ge(a,t){const e=qt[a.charCodeAt(t)];return e==null?-1:e}function Ht(a){let t,e=1;return(t=a>>>16)!=0&&(a=t,e+=16),(t=a>>8)!=0&&(a=t,e+=8),(t=a>>4)!=0&&(a=t,e+=4),(t=a>>2)!=0&&(a=t,e+=2),(t=a>>1)!=0&&(e+=1),e}class we{constructor(t){P(this,"m");this.m=t}convert(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}revert(t){return t}reduce(t){t.divRemTo(this.m,void 0,t)}mulTo(t,e,n){t.multiplyTo(e,n),this.reduce(n)}sqrTo(t,e){t.squareTo(e),this.reduce(e)}}class ve{constructor(t){P(this,"m");P(this,"mp");P(this,"mpl");P(this,"mph");P(this,"um");P(this,"mt2");this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<j.DB-15)-1,this.mt2=2*t.t}convert(t){const e=new j;return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,void 0,e),t.s<0&&e.compareTo(j.ZERO)>0&&this.m.subTo(e,e),e}revert(t){const e=new j;return t.copyTo(e),this.reduce(e),e}reduce(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(let e=0;e<this.m.t;++e){let n=32767&t[e];const r=n*this.mpl+((n*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&j.DM;for(n=e+this.m.t,t[n]+=this.m.am(0,r,t,e,0,this.m.t);t[n]>=j.DV;)t[n]-=j.DV,t[++n]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}sqrTo(t,e){t.squareTo(e),this.reduce(e)}mulTo(t,e,n){t.multiplyTo(e,n),this.reduce(n)}}function bn(a){if(a===0)return-1;let t=0;return(65535&a)==0&&(a>>=16,t+=16),(255&a)==0&&(a>>=8,t+=8),(15&a)==0&&(a>>=4,t+=4),(3&a)==0&&(a>>=2,t+=2),(1&a)==0&&++t,t}function Sn(a){let t=0;for(;a!==0;)a&=a-1,++t;return t}class Tn{constructor(){P(this,"convert",ye);P(this,"revert",ye);P(this,"reduce",()=>{})}mulTo(t,e,n){t.multiplyTo(e,n)}sqrTo(t,e){t.squareTo(e)}}function ye(a){return a}class An{constructor(t){P(this,"r2");P(this,"q3");P(this,"mu");P(this,"m");this.r2=new j,this.q3=new j,j.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}convert(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;{const e=new j;return t.copyTo(e),this.reduce(e),e}}revert(t){return t}reduce(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}sqrTo(t,e){t.squareTo(e),this.reduce(e)}mulTo(t,e,n){t.multiplyTo(e,n),this.reduce(n)}}function ie(a){a=a.replace(/\r\n/g,`
`);let t="";for(let e=0;e<a.length;e++){const n=a.charCodeAt(e);n<128?t+=String.fromCharCode(n):n>127&&n<2048?(t+=String.fromCharCode(n>>6|192),t+=String.fromCharCode(63&n|128)):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128),t+=String.fromCharCode(63&n|128))}return t}const Re=function(a){function t(v,E){const B=(65535&v)+(65535&E);return(v>>16)+(E>>16)+(B>>16)<<16|65535&B}function e(v,E){return v>>>E|v<<32-E}function n(v,E){return v>>>E}function r(v,E,B){return v&E^~v&B}function i(v,E,B){return v&E^v&B^E&B}function o(v){return e(v,2)^e(v,13)^e(v,22)}function c(v){return e(v,6)^e(v,11)^e(v,25)}function h(v){return e(v,7)^e(v,18)^n(v,3)}return function(v){const E="0123456789abcdef";let B="";for(let x=0;x<4*v.length;x++)B+=E.charAt(v[x>>2]>>8*(3-x%4)+4&15)+E.charAt(v[x>>2]>>8*(3-x%4)&15);return B}(function(v,E){const B=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],x=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],b=new Array(64);let S,g,m,T,L,K,z,$,_,q;v[E>>5]|=128<<24-E%32,v[15+(E+64>>9<<4)]=E;for(let G=0;G<v.length;G+=16){S=x[0],g=x[1],m=x[2],T=x[3],L=x[4],K=x[5],z=x[6],$=x[7];for(let et=0;et<64;et++)b[et]=et<16?v[et+G]:t(t(t(e(Q=b[et-2],17)^e(Q,19)^n(Q,10),b[et-7]),h(b[et-15])),b[et-16]),_=t(t(t(t($,c(L)),r(L,K,z)),B[et]),b[et]),q=t(o(S),i(S,g,m)),$=z,z=K,K=L,L=t(T,_),T=m,m=g,g=S,S=t(_,q);x[0]=t(S,x[0]),x[1]=t(g,x[1]),x[2]=t(m,x[2]),x[3]=t(T,x[3]),x[4]=t(L,x[4]),x[5]=t(K,x[5]),x[6]=t(z,x[6]),x[7]=t($,x[7])}var Q;return x}(function(v){const E=[];for(let B=0;B<8*v.length;B+=8)E[B>>5]|=(255&v.charCodeAt(B/8))<<24-B%32;return E}(a=ie(a)),8*a.length))},En=function(a){function t(z,$){return z<<$|z>>>32-$}function e(z){let $,_="";for(let q=7;q>=0;q--)$=z>>>4*q&15,_+=$.toString(16);return _}let n,r,i;const o=new Array(80);let c,h,v,E,B,x,b=1732584193,S=4023233417,g=2562383102,m=271733878,T=3285377520;const L=(a=ie(a)).length,K=[];for(r=0;r<L-3;r+=4)i=a.charCodeAt(r)<<24|a.charCodeAt(r+1)<<16|a.charCodeAt(r+2)<<8|a.charCodeAt(r+3),K.push(i);switch(L%4){case 0:r=2147483648;break;case 1:r=a.charCodeAt(L-1)<<24|8388608;break;case 2:r=a.charCodeAt(L-2)<<24|a.charCodeAt(L-1)<<16|32768;break;case 3:r=a.charCodeAt(L-3)<<24|a.charCodeAt(L-2)<<16|a.charCodeAt(L-1)<<8|128}for(K.push(r);K.length%16!=14;)K.push(0);for(K.push(L>>>29),K.push(L<<3&4294967295),n=0;n<K.length;n+=16){for(r=0;r<16;r++)o[r]=K[n+r];for(r=16;r<=79;r++)o[r]=t(o[r-3]^o[r-8]^o[r-14]^o[r-16],1);for(c=b,h=S,v=g,E=m,B=T,r=0;r<=19;r++)x=t(c,5)+(h&v|~h&E)+B+o[r]+1518500249&4294967295,B=E,E=v,v=t(h,30),h=c,c=x;for(r=20;r<=39;r++)x=t(c,5)+(h^v^E)+B+o[r]+1859775393&4294967295,B=E,E=v,v=t(h,30),h=c,c=x;for(r=40;r<=59;r++)x=t(c,5)+(h&v|h&E|v&E)+B+o[r]+2400959708&4294967295,B=E,E=v,v=t(h,30),h=c,c=x;for(r=60;r<=79;r++)x=t(c,5)+(h^v^E)+B+o[r]+3395469782&4294967295,B=E,E=v,v=t(h,30),h=c,c=x;b=b+c&4294967295,S=S+h&4294967295,g=g+v&4294967295,m=m+E&4294967295,T=T+B&4294967295}return(e(b)+e(S)+e(g)+e(m)+e(T)).toLowerCase()},Cn=function(a){function t(L,K){return L<<K|L>>>32-K}function e(L,K){const z=2147483648&L,$=2147483648&K,_=1073741824&L,q=1073741824&K,Q=(1073741823&L)+(1073741823&K);return _&q?2147483648^Q^z^$:_|q?1073741824&Q?3221225472^Q^z^$:1073741824^Q^z^$:Q^z^$}function n(L,K,z,$,_,q,Q){return L=e(L,e(e(function(G,et,at){return G&et|~G&at}(K,z,$),_),Q)),e(t(L,q),K)}function r(L,K,z,$,_,q,Q){return L=e(L,e(e(function(G,et,at){return G&at|et&~at}(K,z,$),_),Q)),e(t(L,q),K)}function i(L,K,z,$,_,q,Q){return L=e(L,e(e(function(G,et,at){return G^et^at}(K,z,$),_),Q)),e(t(L,q),K)}function o(L,K,z,$,_,q,Q){return L=e(L,e(e(function(G,et,at){return et^(G|~at)}(K,z,$),_),Q)),e(t(L,q),K)}function c(L){let K,z,$="",_="";for(z=0;z<=3;z++)K=L>>>8*z&255,_="0"+K.toString(16),$+=_.substr(_.length-2,2);return $}let h,v,E,B,x,b,S,g,m;const T=function(L){let K;const z=L.length,$=z+8,_=16*(($-$%64)/64+1),q=Array(_-1);let Q=0,G=0;for(;G<z;)K=(G-G%4)/4,Q=G%4*8,q[K]=q[K]|L.charCodeAt(G)<<Q,G++;return K=(G-G%4)/4,Q=G%4*8,q[K]=q[K]|128<<Q,q[_-2]=z<<3,q[_-1]=z>>>29,q}(a=ie(a));for(b=1732584193,S=4023233417,g=2562383102,m=271733878,h=0;h<T.length;h+=16)v=b,E=S,B=g,x=m,b=n(b,S,g,m,T[h+0],7,3614090360),m=n(m,b,S,g,T[h+1],12,3905402710),g=n(g,m,b,S,T[h+2],17,606105819),S=n(S,g,m,b,T[h+3],22,3250441966),b=n(b,S,g,m,T[h+4],7,4118548399),m=n(m,b,S,g,T[h+5],12,1200080426),g=n(g,m,b,S,T[h+6],17,2821735955),S=n(S,g,m,b,T[h+7],22,4249261313),b=n(b,S,g,m,T[h+8],7,1770035416),m=n(m,b,S,g,T[h+9],12,2336552879),g=n(g,m,b,S,T[h+10],17,4294925233),S=n(S,g,m,b,T[h+11],22,2304563134),b=n(b,S,g,m,T[h+12],7,1804603682),m=n(m,b,S,g,T[h+13],12,4254626195),g=n(g,m,b,S,T[h+14],17,2792965006),S=n(S,g,m,b,T[h+15],22,1236535329),b=r(b,S,g,m,T[h+1],5,4129170786),m=r(m,b,S,g,T[h+6],9,3225465664),g=r(g,m,b,S,T[h+11],14,643717713),S=r(S,g,m,b,T[h+0],20,3921069994),b=r(b,S,g,m,T[h+5],5,3593408605),m=r(m,b,S,g,T[h+10],9,38016083),g=r(g,m,b,S,T[h+15],14,3634488961),S=r(S,g,m,b,T[h+4],20,3889429448),b=r(b,S,g,m,T[h+9],5,568446438),m=r(m,b,S,g,T[h+14],9,3275163606),g=r(g,m,b,S,T[h+3],14,4107603335),S=r(S,g,m,b,T[h+8],20,1163531501),b=r(b,S,g,m,T[h+13],5,2850285829),m=r(m,b,S,g,T[h+2],9,4243563512),g=r(g,m,b,S,T[h+7],14,1735328473),S=r(S,g,m,b,T[h+12],20,2368359562),b=i(b,S,g,m,T[h+5],4,4294588738),m=i(m,b,S,g,T[h+8],11,2272392833),g=i(g,m,b,S,T[h+11],16,1839030562),S=i(S,g,m,b,T[h+14],23,4259657740),b=i(b,S,g,m,T[h+1],4,2763975236),m=i(m,b,S,g,T[h+4],11,1272893353),g=i(g,m,b,S,T[h+7],16,4139469664),S=i(S,g,m,b,T[h+10],23,3200236656),b=i(b,S,g,m,T[h+13],4,681279174),m=i(m,b,S,g,T[h+0],11,3936430074),g=i(g,m,b,S,T[h+3],16,3572445317),S=i(S,g,m,b,T[h+6],23,76029189),b=i(b,S,g,m,T[h+9],4,3654602809),m=i(m,b,S,g,T[h+12],11,3873151461),g=i(g,m,b,S,T[h+15],16,530742520),S=i(S,g,m,b,T[h+2],23,3299628645),b=o(b,S,g,m,T[h+0],6,4096336452),m=o(m,b,S,g,T[h+7],10,1126891415),g=o(g,m,b,S,T[h+14],15,2878612391),S=o(S,g,m,b,T[h+5],21,4237533241),b=o(b,S,g,m,T[h+12],6,1700485571),m=o(m,b,S,g,T[h+3],10,2399980690),g=o(g,m,b,S,T[h+10],15,4293915773),S=o(S,g,m,b,T[h+1],21,2240044497),b=o(b,S,g,m,T[h+8],6,1873313359),m=o(m,b,S,g,T[h+15],10,4264355552),g=o(g,m,b,S,T[h+6],15,2734768916),S=o(S,g,m,b,T[h+13],21,1309151649),b=o(b,S,g,m,T[h+4],6,4149444226),m=o(m,b,S,g,T[h+11],10,3174756917),g=o(g,m,b,S,T[h+2],15,718787259),S=o(S,g,m,b,T[h+9],21,3951481745),b=e(b,v),S=e(S,E),g=e(g,B),m=e(m,x);return(c(b)+c(S)+c(g)+c(m)).toLowerCase()};function rt(a,t){return new j(a,t)}function xn(a,t){if(t<a.length+11)throw"Message too long for RSA (n="+t+", l="+a.length+")";const e=[];let n=a.length-1;for(;n>=0&&t>0;){const o=a.charCodeAt(n--);o<128?e[--t]=o:o>127&&o<2048?(e[--t]=63&o|128,e[--t]=o>>6|192):(e[--t]=63&o|128,e[--t]=o>>6&63|128,e[--t]=o>>12|224)}e[--t]=0;const r=new ee,i=[];for(;t>2;){for(i[0]=0;i[0]===0;)r.nextBytes(i);e[--t]=i[0]}return e[--t]=2,e[--t]=0,new j(e)}class Nt{constructor(){P(this,"n",new j);P(this,"e",0);P(this,"d",new j);P(this,"p",new j);P(this,"q",new j);P(this,"dmp1",new j);P(this,"dmq1",new j);P(this,"coeff",new j);P(this,"signString",Nn);P(this,"signStringWithSHA1",Rn);P(this,"signStringWithSHA256",Bn);P(this,"verifyHexSignatureForMessage",Dn);P(this,"verifyString",Ln)}setPublic(t,e){if(!t||!e)throw"Invalid RSA public key";this.n=rt(t,16),this.e=parseInt(e,16)}doPublic(t){return t.modPowInt(this.e,this.n)}encrypt(t){const e=xn(t,this.n.bitLength()+7>>3),n=this.doPublic(e).toString(16);return(1&n.length)==0?n:"0"+n}setPrivate(t,e,n){if(!(!t&&!e&&t.length>0&&e.length>0))throw"Invalid RSA private key";this.n=rt(t,16),this.e=parseInt(e,16),this.d=rt(n,16)}setPrivateEx(t,e,n,r,i,o,c,h){if(!(!t&&!e&&t.length>0&&e.length>0))throw new Error("Invalid RSA private key");this.n=rt(t,16),this.e=parseInt(e,16),this.d=rt(n,16),this.p=rt(r,16),this.q=rt(i,16),this.dmp1=rt(o,16),this.dmq1=rt(c,16),this.coeff=rt(h,16)}generate(t,e){const n=new gn,r=t>>1;this.e=parseInt(e,16);const i=new j(e,16);for(;;){for(;this.p=new j(t-r,1,n),this.p.subtract(j.ONE).gcd(i).compareTo(j.ONE)!==0||!this.p.isProbablePrime(10););for(;this.q=new j(r,1,n),this.q.subtract(j.ONE).gcd(i).compareTo(j.ONE)!==0||!this.q.isProbablePrime(10););if(this.p.compareTo(this.q)<=0){const v=this.p;this.p=this.q,this.q=v}const o=this.p.subtract(j.ONE),c=this.q.subtract(j.ONE),h=o.multiply(c);if(h.gcd(i).compareTo(j.ONE)===0){this.n=this.p.multiply(this.q),this.d=i.modInverse(h),this.dmp1=this.d.mod(o),this.dmq1=this.d.mod(c),this.coeff=this.q.modInverse(this.p);break}}}doPrivate(t){if(!this.p||!this.q)return t.modPow(this.d,this.n);let e=t.mod(this.p).modPow(this.dmp1,this.p);const n=t.mod(this.q).modPow(this.dmq1,this.q);for(;e.compareTo(n)<0;)e=e.add(this.p);return e.subtract(n).multiply(this.coeff).mod(this.p).multiply(this.q).add(n)}decrypt(t){const e=rt(t,16),n=this.doPrivate(e);return n instanceof j?In(n,this.n.bitLength()+7>>3):null}toJSON(){return JSON.stringify({coeff:this.coeff.toString(16),d:this.d.toString(16),dmp1:this.dmp1.toString(16),dmq1:this.dmq1.toString(16),e:this.e.toString(16),n:this.n.toString(16),p:this.p.toString(16),q:this.q.toString(16)})}static parse(t){const e=typeof t=="string"?JSON.parse(t):t;if(!e)return null;const n=new Nt;return n.setPrivateEx(e.n,e.e,e.d,e.p,e.q,e.dmp1,e.dmq1,e.coeff),n}}function In(a,t){const e=a.toByteArray();let n=0;for(;n<e.length&&e[n]===0;)++n;if(e.length-n!=t-1||e[n]!==2)return null;for(++n;e[n]!==0;)if(++n>=e.length)return null;let r="";for(;++n<e.length;){const i=255&e[n];i<128?r+=String.fromCharCode(i):i>191&&i<224?(r+=String.fromCharCode((31&i)<<6|63&e[n+1]),++n):(r+=String.fromCharCode((15&i)<<12|(63&e[n+1])<<6|63&e[n+2]),n+=2)}return r}const ne={sha1:"3021300906052b0e03021a05000414",sha256:"3031300d060960864801650304020105000420"},oe={sha1:En,sha256:Re};function se(a,t,e){const n=t/4,r=(0,oe[e])(a),i="0001",o="00"+ne[e]+r;let c="";const h=n-i.length-o.length;for(let v=0;v<h;v+=2)c+="ff";return i+c+o}function Nn(a,t){const e=rt(se(a,this.n.bitLength(),t),16);return this.doPrivate(e).toString(16)}function Rn(a){const t=rt(se(a,this.n.bitLength(),"sha1"),16);return this.doPrivate(t).toString(16)}function Bn(a){const t=rt(se(a,this.n.bitLength(),"sha256"),16);return this.doPrivate(t).toString(16)}function Mn(a,t,e){return function(n,r,i){const o=new Nt;return o.setPublic(r,i),o.doPublic(n)}(a,t,e).toString(16).replace(/^1f+00/,"")}function Be(a){for(const t in ne){const e=ne[t],n=e.length;if(a.substring(0,n)===e)return[t,a.substring(n)]}return[]}function Dn(a,t){return function(e,n,r,i){const o=Be(Mn(n,r,i));if(o.length===0)return!1;const c=o[0];return o[1]===(0,oe[c])(e)}(a,rt(t,16),this.n.toString(16),this.e.toString(16))}function Ln(a,t){const e=rt(t=t.replace(/[ \n]+/g,""),16),n=Be(this.doPublic(e).toString(16).replace(/^1f+00/,""));if(n.length===0)return!1;const r=n[0];return n[1]===(0,oe[r])(a)}const ht="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Jt="::52cee64bb3a38f6403386519a39ac91c::";F.Init();class be{static b256to64(t){let e,n,r=0,i="",o=0;const c=t.length;for(n=0;n<c;n++)e=t.charCodeAt(n),o===0?(i+=ht.charAt(e>>2&63),r=(3&e)<<4):o===1?(i+=ht.charAt(r|e>>4&15),r=(15&e)<<2):o===2&&(i+=ht.charAt(r|e>>6&3),i+=ht.charAt(63&e)),o+=1,o===3&&(o=0);return o>0&&(i+=ht.charAt(r),i+="="),o===1&&(i+="="),i}static b64to256(t){let e,n,r="",i=0,o=0;const c=t.length;for(n=0;n<c;n++)e=ht.indexOf(t.charAt(n)),e>=0&&(i&&(r+=String.fromCharCode(o|e>>6-i&255)),i=i+2&7,o=e<<i&255);return r}static b16to64(t){let e,n,r="";for(t.length%2==1&&(t="0"+t),e=0;e+3<=t.length;e+=3)n=parseInt(t.substring(e,e+3),16),r+=ht.charAt(n>>6)+ht.charAt(63&n);for(e+1===t.length?(n=parseInt(t.substring(e,e+1),16),r+=ht.charAt(n<<2)):e+2===t.length&&(n=parseInt(t.substring(e,e+2),16),r+=ht.charAt(n>>2)+ht.charAt((3&n)<<4));(3&r.length)>0;)r+="=";return r}static b64to16(t){let e,n="",r=0,i=0;for(e=0;e<t.length&&t.charAt(e)!=="=";++e){const o=ht.indexOf(t.charAt(e));o<0||(r===0?(n+=bt(o>>2),i=3&o,r=1):r===1?(n+=bt(i<<2|o>>4),i=15&o,r=2):r===2?(n+=bt(i),n+=bt(o>>2),i=3&o,r=3):(n+=bt(i<<2|o>>4),n+=bt(15&o),r=0))}return r===1&&(n+=bt(i<<2)),n}static string2bytes(t){const e=[];for(let n=0;n<t.length;n++)e.push(t.charCodeAt(n));return e}static bytes2string(t){let e="";for(let n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e}static utf82string(t){return unescape(encodeURIComponent(t))}static string2utf8(t){return decodeURIComponent(escape(t))}static utf82bytes(t){const e=unescape(encodeURIComponent(t));return this.string2bytes(e)}static bytes2utf8(t){const e=this.bytes2string(t);return decodeURIComponent(escape(e))}static blockXOR(t,e){const n=new Array(16);for(let r=0;r<16;r++)n[r]=t[r]^e[r];return n}static blockIV(){const t=new ee,e=new Array(16);return t.nextBytes(e),e}static pad16(t){const e=t.slice(0),n=(16-t.length%16)%16;for(let r=t.length;r<t.length+n;r++)e.push(0);return e}static depad(t){let e=t.slice(0);for(;e[e.length-1]===0;)e=e.slice(0,e.length-1);return e}static encryptAESCBC(t,e){const n=e.slice(0);F.ExpandKey(n);let r=this.utf82bytes(t);r=this.pad16(r);let i=this.blockIV();for(let c=0;c<r.length/16;c++){let h=r.slice(16*c,16*c+16);const v=i.slice(16*c,16*c+16);h=this.blockXOR(v,h),F.Encrypt(h,n),i=i.concat(h)}const o=this.bytes2string(i);return this.b256to64(o)}static decryptAESCBC(t,e){const n=e.slice(0);F.ExpandKey(n);const r=this.b64to256(t),i=this.string2bytes(r);let o=[];for(let c=1;c<i.length/16;c++){let h=i.slice(16*c,16*c+16);const v=i.slice(16*(c-1),16*(c-1)+16);F.Decrypt(h,n),h=this.blockXOR(v,h),o=o.concat(h)}return o=this.depad(o),this.bytes2utf8(o)}static wrap60(t){let e="";for(let n=0;n<t.length;n++)n%60==0&&n!==0&&(e+=`
`),e+=t[n];return e}static generateAESKey(){const t=new Array(32);return new ee().nextBytes(t),t}static generateRSAKey(t,e){Pt.seedrandom(Re(t));const n=new Nt;return n.generate(e,"03"),n}static publicKeyString(t){return this.b16to64(t.n.toString(16))}static publicKeyID(t){return Cn(t)}static publicKeyFromString(t){const e=this.b64to16(t.split("|")[0]),n=new Nt;return n.setPublic(e,"03"),n}static encrypt(t,e,n){{let r="";const i=this.generateAESKey();try{const o=this.publicKeyFromString(e);r+=this.b16to64(o.encrypt(this.bytes2string(i)))+"?"}catch{return{status:"Invalid public key"}}if(n){const o=this.sign(t,n);t+=Jt,t+=this.publicKeyString(n),t+=Jt,t+=o}return r+=this.encryptAESCBC(t,i),{status:"success",cipher:r}}}static decrypt(t,e){const n=t.split("?"),r=e.decrypt(this.b64to16(n[0]));if(r==null)return{status:"failure"};const i=this.string2bytes(r),o=this.decryptAESCBC(n[1],i).split(Jt);return o.length>1?this._confirm(o):{status:"success",plaintext:o[0],signature:"unsigned"}}static sign(t,e){return this.b16to64(e.signString(t,"sha256"))}static verify(t){const e=this._confirm(t);return e.status==="success"&&e.signature==="verified"}static _confirm(t){if(t.length===3){const e=this.publicKeyFromString(t[1]),n=this.b64to16(t[2]);return e.verifyString(t[0],n)?{status:"success",plaintext:t[0],signature:"verified",publicKeyString:this.publicKeyString(e)}:{status:"success",plaintext:t[0],signature:"forged",publicKeyString:this.publicKeyString(e)}}return{status:"failure"}}}function kn(a,t){const e=be.generateRSAKey(t,1024),n=be.decrypt(decodeURIComponent(a),e);if(n.status=="failure")throw"\u89E3\u5BC6\u5931\u8D25";return decodeURIComponent(n.plaintext)}var Me={exports:{}};(function(a,t){(function(e,n){a.exports=n()})(Ee,function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function n(d,s,l,f){var p,u,A,C=s||[0],I=(l=l||0)>>>3,M=f===-1?3:0;for(p=0;p<d.length;p+=1)u=(A=p+I)>>>2,C.length<=u&&C.push(0),C[u]|=d[p]<<8*(M+f*(A%4));return{value:C,binLen:8*d.length+l}}function r(d,s,l){switch(s){case"UTF8":case"UTF16BE":case"UTF16LE":break;default:throw new Error("encoding must be UTF8, UTF16BE, or UTF16LE")}switch(d){case"HEX":return function(f,p,u){return function(A,C,I,M){var H,R,D,X;if(A.length%2!=0)throw new Error("String of HEX type must be in byte increments");var N=C||[0],J=(I=I||0)>>>3,W=M===-1?3:0;for(H=0;H<A.length;H+=2){if(R=parseInt(A.substr(H,2),16),isNaN(R))throw new Error("String of HEX type contains invalid characters");for(D=(X=(H>>>1)+J)>>>2;N.length<=D;)N.push(0);N[D]|=R<<8*(W+M*(X%4))}return{value:N,binLen:4*A.length+I}}(f,p,u,l)};case"TEXT":return function(f,p,u){return function(A,C,I,M,H){var R,D,X,N,J,W,tt,nt,vt=0,ut=I||[0],ft=(M=M||0)>>>3;if(C==="UTF8")for(tt=H===-1?3:0,X=0;X<A.length;X+=1)for(D=[],128>(R=A.charCodeAt(X))?D.push(R):2048>R?(D.push(192|R>>>6),D.push(128|63&R)):55296>R||57344<=R?D.push(224|R>>>12,128|R>>>6&63,128|63&R):(X+=1,R=65536+((1023&R)<<10|1023&A.charCodeAt(X)),D.push(240|R>>>18,128|R>>>12&63,128|R>>>6&63,128|63&R)),N=0;N<D.length;N+=1){for(J=(W=vt+ft)>>>2;ut.length<=J;)ut.push(0);ut[J]|=D[N]<<8*(tt+H*(W%4)),vt+=1}else for(tt=H===-1?2:0,nt=C==="UTF16LE"&&H!==1||C!=="UTF16LE"&&H===1,X=0;X<A.length;X+=1){for(R=A.charCodeAt(X),nt===!0&&(R=(N=255&R)<<8|R>>>8),J=(W=vt+ft)>>>2;ut.length<=J;)ut.push(0);ut[J]|=R<<8*(tt+H*(W%4)),vt+=2}return{value:ut,binLen:8*vt+M}}(f,s,p,u,l)};case"B64":return function(f,p,u){return function(A,C,I,M){var H,R,D,X,N,J,W=0,tt=C||[0],nt=(I=I||0)>>>3,vt=M===-1?3:0,ut=A.indexOf("=");if(A.search(/^[a-zA-Z0-9=+/]+$/)===-1)throw new Error("Invalid character in base-64 string");if(A=A.replace(/=/g,""),ut!==-1&&ut<A.length)throw new Error("Invalid '=' found in base-64 string");for(H=0;H<A.length;H+=4){for(X=A.substr(H,4),D=0,R=0;R<X.length;R+=1)D|=e.indexOf(X.charAt(R))<<18-6*R;for(R=0;R<X.length-1;R+=1){for(N=(J=W+nt)>>>2;tt.length<=N;)tt.push(0);tt[N]|=(D>>>16-8*R&255)<<8*(vt+M*(J%4)),W+=1}}return{value:tt,binLen:8*W+I}}(f,p,u,l)};case"BYTES":return function(f,p,u){return function(A,C,I,M){var H,R,D,X,N=C||[0],J=(I=I||0)>>>3,W=M===-1?3:0;for(R=0;R<A.length;R+=1)H=A.charCodeAt(R),D=(X=R+J)>>>2,N.length<=D&&N.push(0),N[D]|=H<<8*(W+M*(X%4));return{value:N,binLen:8*A.length+I}}(f,p,u,l)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch{throw new Error("ARRAYBUFFER not supported by this environment")}return function(f,p,u){return function(A,C,I,M){return n(new Uint8Array(A),C,I,M)}(f,p,u,l)};case"UINT8ARRAY":try{new Uint8Array(0)}catch{throw new Error("UINT8ARRAY not supported by this environment")}return function(f,p,u){return n(f,p,u,l)};default:throw new Error("format must be HEX, TEXT, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}function i(d,s,l,f){switch(d){case"HEX":return function(p){return function(u,A,C,I){var M,H,R="",D=A/8,X=C===-1?3:0;for(M=0;M<D;M+=1)H=u[M>>>2]>>>8*(X+C*(M%4)),R+="0123456789abcdef".charAt(H>>>4&15)+"0123456789abcdef".charAt(15&H);return I.outputUpper?R.toUpperCase():R}(p,s,l,f)};case"B64":return function(p){return function(u,A,C,I){var M,H,R,D,X,N="",J=A/8,W=C===-1?3:0;for(M=0;M<J;M+=3)for(D=M+1<J?u[M+1>>>2]:0,X=M+2<J?u[M+2>>>2]:0,R=(u[M>>>2]>>>8*(W+C*(M%4))&255)<<16|(D>>>8*(W+C*((M+1)%4))&255)<<8|X>>>8*(W+C*((M+2)%4))&255,H=0;H<4;H+=1)N+=8*M+6*H<=A?e.charAt(R>>>6*(3-H)&63):I.b64Pad;return N}(p,s,l,f)};case"BYTES":return function(p){return function(u,A,C){var I,M,H="",R=A/8,D=C===-1?3:0;for(I=0;I<R;I+=1)M=u[I>>>2]>>>8*(D+C*(I%4))&255,H+=String.fromCharCode(M);return H}(p,s,l)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch{throw new Error("ARRAYBUFFER not supported by this environment")}return function(p){return function(u,A,C){var I,M=A/8,H=new ArrayBuffer(M),R=new Uint8Array(H),D=C===-1?3:0;for(I=0;I<M;I+=1)R[I]=u[I>>>2]>>>8*(D+C*(I%4))&255;return H}(p,s,l)};case"UINT8ARRAY":try{new Uint8Array(0)}catch{throw new Error("UINT8ARRAY not supported by this environment")}return function(p){return function(u,A,C){var I,M=A/8,H=C===-1?3:0,R=new Uint8Array(M);for(I=0;I<M;I+=1)R[I]=u[I>>>2]>>>8*(H+C*(I%4))&255;return R}(p,s,l)};default:throw new Error("format must be HEX, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}var o=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],c=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428],h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],v="Chosen SHA variant is not supported";function E(d,s){var l,f,p=d.binLen>>>3,u=s.binLen>>>3,A=p<<3,C=4-p<<3;if(p%4!=0){for(l=0;l<u;l+=4)f=p+l>>>2,d.value[f]|=s.value[l>>>2]<<A,d.value.push(0),d.value[f+1]|=s.value[l>>>2]>>>C;return(d.value.length<<2)-4>=u+p&&d.value.pop(),{value:d.value,binLen:d.binLen+s.binLen}}return{value:d.value.concat(s.value),binLen:d.binLen+s.binLen}}function B(d){var s={outputUpper:!1,b64Pad:"=",outputLen:-1},l=d||{},f="Output length must be a multiple of 8";if(s.outputUpper=l.outputUpper||!1,l.b64Pad&&(s.b64Pad=l.b64Pad),l.outputLen){if(l.outputLen%8!=0)throw new Error(f);s.outputLen=l.outputLen}else if(l.shakeLen){if(l.shakeLen%8!=0)throw new Error(f);s.outputLen=l.shakeLen}if(typeof s.outputUpper!="boolean")throw new Error("Invalid outputUpper formatting option");if(typeof s.b64Pad!="string")throw new Error("Invalid b64Pad formatting option");return s}function x(d,s,l,f){var p=d+" must include a value and format";if(!s){if(!f)throw new Error(p);return f}if(s.value===void 0||!s.format)throw new Error(p);return r(s.format,s.encoding||"UTF8",l)(s.value)}var b=function(){function d(s,l,f){var p=f||{};if(this.t=l,this.i=p.encoding||"UTF8",this.numRounds=p.numRounds||1,isNaN(this.numRounds)||this.numRounds!==parseInt(this.numRounds,10)||1>this.numRounds)throw new Error("numRounds must a integer >= 1");this.o=s,this.u=[],this.s=0,this.h=!1,this.v=0,this.A=!1,this.l=[],this.H=[]}return d.prototype.update=function(s){var l,f=0,p=this.S>>>5,u=this.p(s,this.u,this.s),A=u.binLen,C=u.value,I=A>>>5;for(l=0;l<I;l+=p)f+this.S<=A&&(this.m=this.R(C.slice(l,l+p),this.m),f+=this.S);this.v+=f,this.u=C.slice(f>>>5),this.s=A%this.S,this.h=!0},d.prototype.getHash=function(s,l){var f,p,u=this.U,A=B(l);if(this.T){if(A.outputLen===-1)throw new Error("Output length must be specified in options");u=A.outputLen}var C=i(s,u,this.C,A);if(this.A&&this.F)return C(this.F(A));for(p=this.K(this.u.slice(),this.s,this.v,this.B(this.m),u),f=1;f<this.numRounds;f+=1)this.T&&u%32!=0&&(p[p.length-1]&=16777215>>>24-u%32),p=this.K(p,u,0,this.L(this.o),u);return C(p)},d.prototype.setHMACKey=function(s,l,f){if(!this.g)throw new Error("Variant does not support HMAC");if(this.h)throw new Error("Cannot set MAC key after calling update");var p=r(l,(f||{}).encoding||"UTF8",this.C);this.k(p(s))},d.prototype.k=function(s){var l,f=this.S>>>3,p=f/4-1;if(this.numRounds!==1)throw new Error("Cannot set numRounds with MAC");if(this.A)throw new Error("MAC key already set");for(f<s.binLen/8&&(s.value=this.K(s.value,s.binLen,0,this.L(this.o),this.U));s.value.length<=p;)s.value.push(0);for(l=0;l<=p;l+=1)this.l[l]=909522486^s.value[l],this.H[l]=1549556828^s.value[l];this.m=this.R(this.l,this.m),this.v=this.S,this.A=!0},d.prototype.getHMAC=function(s,l){var f=B(l);return i(s,this.U,this.C,f)(this.Y())},d.prototype.Y=function(){var s;if(!this.A)throw new Error("Cannot call getHMAC without first setting MAC key");var l=this.K(this.u.slice(),this.s,this.v,this.B(this.m),this.U);return s=this.R(this.H,this.L(this.o)),s=this.K(l,this.U,this.S,s,this.U)},d}(),S=function(d,s){return(S=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,f){l.__proto__=f}||function(l,f){for(var p in f)Object.prototype.hasOwnProperty.call(f,p)&&(l[p]=f[p])})(d,s)};function g(d,s){function l(){this.constructor=d}S(d,s),d.prototype=s===null?Object.create(s):(l.prototype=s.prototype,new l)}function m(d,s){return d<<s|d>>>32-s}function T(d,s){return d>>>s|d<<32-s}function L(d,s){return d>>>s}function K(d,s,l){return d^s^l}function z(d,s,l){return d&s^~d&l}function $(d,s,l){return d&s^d&l^s&l}function _(d){return T(d,2)^T(d,13)^T(d,22)}function q(d,s){var l=(65535&d)+(65535&s);return(65535&(d>>>16)+(s>>>16)+(l>>>16))<<16|65535&l}function Q(d,s,l,f){var p=(65535&d)+(65535&s)+(65535&l)+(65535&f);return(65535&(d>>>16)+(s>>>16)+(l>>>16)+(f>>>16)+(p>>>16))<<16|65535&p}function G(d,s,l,f,p){var u=(65535&d)+(65535&s)+(65535&l)+(65535&f)+(65535&p);return(65535&(d>>>16)+(s>>>16)+(l>>>16)+(f>>>16)+(p>>>16)+(u>>>16))<<16|65535&u}function et(d){return T(d,7)^T(d,18)^L(d,3)}function at(d){return T(d,6)^T(d,11)^T(d,25)}function Vt(d){return[1732584193,4023233417,2562383102,271733878,3285377520]}function At(d,s){var l,f,p,u,A,C,I,M=[];for(l=s[0],f=s[1],p=s[2],u=s[3],A=s[4],I=0;I<80;I+=1)M[I]=I<16?d[I]:m(M[I-3]^M[I-8]^M[I-14]^M[I-16],1),C=I<20?G(m(l,5),z(f,p,u),A,1518500249,M[I]):I<40?G(m(l,5),K(f,p,u),A,1859775393,M[I]):I<60?G(m(l,5),$(f,p,u),A,2400959708,M[I]):G(m(l,5),K(f,p,u),A,3395469782,M[I]),A=u,u=p,p=m(f,30),f=l,l=C;return s[0]=q(l,s[0]),s[1]=q(f,s[1]),s[2]=q(p,s[2]),s[3]=q(u,s[3]),s[4]=q(A,s[4]),s}function jt(d,s,l,f){for(var p,u=15+(s+65>>>9<<4),A=s+l;d.length<=u;)d.push(0);for(d[s>>>5]|=128<<24-s%32,d[u]=4294967295&A,d[u-1]=A/4294967296|0,p=0;p<d.length;p+=16)f=At(d.slice(p,p+16),f);return f}var Yt=function(d){function s(l,f,p){var u=this;if(l!=="SHA-1")throw new Error(v);var A=p||{};return(u=d.call(this,l,f,p)||this).g=!0,u.F=u.Y,u.C=-1,u.p=r(u.t,u.i,u.C),u.R=At,u.B=function(C){return C.slice()},u.L=Vt,u.K=jt,u.m=[1732584193,4023233417,2562383102,271733878,3285377520],u.S=512,u.U=160,u.T=!1,A.hmacKey&&u.k(x("hmacKey",A.hmacKey,u.C)),u}return g(s,d),s}(b);function Rt(d){return d=="SHA-224"?c.slice():h.slice()}function Bt(d,s){var l,f,p,u,A,C,I,M,H,R,D,X,N=[];for(l=s[0],f=s[1],p=s[2],u=s[3],A=s[4],C=s[5],I=s[6],M=s[7],D=0;D<64;D+=1)N[D]=D<16?d[D]:Q(T(X=N[D-2],17)^T(X,19)^L(X,10),N[D-7],et(N[D-15]),N[D-16]),H=G(M,at(A),z(A,C,I),o[D],N[D]),R=q(_(l),$(l,f,p)),M=I,I=C,C=A,A=q(u,H),u=p,p=f,f=l,l=q(H,R);return s[0]=q(l,s[0]),s[1]=q(f,s[1]),s[2]=q(p,s[2]),s[3]=q(u,s[3]),s[4]=q(A,s[4]),s[5]=q(C,s[5]),s[6]=q(I,s[6]),s[7]=q(M,s[7]),s}var Et=function(d){function s(l,f,p){var u=this;if(l!=="SHA-224"&&l!=="SHA-256")throw new Error(v);var A=p||{};return(u=d.call(this,l,f,p)||this).F=u.Y,u.g=!0,u.C=-1,u.p=r(u.t,u.i,u.C),u.R=Bt,u.B=function(C){return C.slice()},u.L=Rt,u.K=function(C,I,M,H){return function(R,D,X,N,J){for(var W,tt=15+(D+65>>>9<<4),nt=D+X;R.length<=tt;)R.push(0);for(R[D>>>5]|=128<<24-D%32,R[tt]=4294967295&nt,R[tt-1]=nt/4294967296|0,W=0;W<R.length;W+=16)N=Bt(R.slice(W,W+16),N);return J==="SHA-224"?[N[0],N[1],N[2],N[3],N[4],N[5],N[6]]:N}(C,I,M,H,l)},u.m=Rt(l),u.S=512,u.U=l==="SHA-224"?224:256,u.T=!1,A.hmacKey&&u.k(x("hmacKey",A.hmacKey,u.C)),u}return g(s,d),s}(b),w=function(d,s){this.N=d,this.I=s};function Mt(d,s){var l;return s>32?(l=64-s,new w(d.I<<s|d.N>>>l,d.N<<s|d.I>>>l)):s!==0?(l=32-s,new w(d.N<<s|d.I>>>l,d.I<<s|d.N>>>l)):d}function ct(d,s){var l;return s<32?(l=32-s,new w(d.N>>>s|d.I<<l,d.I>>>s|d.N<<l)):(l=64-s,new w(d.I>>>s|d.N<<l,d.N>>>s|d.I<<l))}function Y(d,s){return new w(d.N>>>s,d.I>>>s|d.N<<32-s)}function O(d,s,l){return new w(d.N&s.N^~d.N&l.N,d.I&s.I^~d.I&l.I)}function k(d,s,l){return new w(d.N&s.N^d.N&l.N^s.N&l.N,d.I&s.I^d.I&l.I^s.I&l.I)}function V(d){var s=ct(d,28),l=ct(d,34),f=ct(d,39);return new w(s.N^l.N^f.N,s.I^l.I^f.I)}function U(d,s){var l,f;l=(65535&d.I)+(65535&s.I);var p=(65535&(f=(d.I>>>16)+(s.I>>>16)+(l>>>16)))<<16|65535&l;return l=(65535&d.N)+(65535&s.N)+(f>>>16),f=(d.N>>>16)+(s.N>>>16)+(l>>>16),new w((65535&f)<<16|65535&l,p)}function Z(d,s,l,f){var p,u;p=(65535&d.I)+(65535&s.I)+(65535&l.I)+(65535&f.I);var A=(65535&(u=(d.I>>>16)+(s.I>>>16)+(l.I>>>16)+(f.I>>>16)+(p>>>16)))<<16|65535&p;return p=(65535&d.N)+(65535&s.N)+(65535&l.N)+(65535&f.N)+(u>>>16),u=(d.N>>>16)+(s.N>>>16)+(l.N>>>16)+(f.N>>>16)+(p>>>16),new w((65535&u)<<16|65535&p,A)}function st(d,s,l,f,p){var u,A;u=(65535&d.I)+(65535&s.I)+(65535&l.I)+(65535&f.I)+(65535&p.I);var C=(65535&(A=(d.I>>>16)+(s.I>>>16)+(l.I>>>16)+(f.I>>>16)+(p.I>>>16)+(u>>>16)))<<16|65535&u;return u=(65535&d.N)+(65535&s.N)+(65535&l.N)+(65535&f.N)+(65535&p.N)+(A>>>16),A=(d.N>>>16)+(s.N>>>16)+(l.N>>>16)+(f.N>>>16)+(p.N>>>16)+(u>>>16),new w((65535&A)<<16|65535&u,C)}function pt(d,s){return new w(d.N^s.N,d.I^s.I)}function ue(d){var s=ct(d,1),l=ct(d,8),f=Y(d,7);return new w(s.N^l.N^f.N,s.I^l.I^f.I)}function Le(d){var s=ct(d,14),l=ct(d,18),f=ct(d,41);return new w(s.N^l.N^f.N,s.I^l.I^f.I)}var ke=[new w(o[0],3609767458),new w(o[1],602891725),new w(o[2],3964484399),new w(o[3],2173295548),new w(o[4],4081628472),new w(o[5],3053834265),new w(o[6],2937671579),new w(o[7],3664609560),new w(o[8],2734883394),new w(o[9],1164996542),new w(o[10],1323610764),new w(o[11],3590304994),new w(o[12],4068182383),new w(o[13],991336113),new w(o[14],633803317),new w(o[15],3479774868),new w(o[16],2666613458),new w(o[17],944711139),new w(o[18],2341262773),new w(o[19],2007800933),new w(o[20],1495990901),new w(o[21],1856431235),new w(o[22],3175218132),new w(o[23],2198950837),new w(o[24],3999719339),new w(o[25],766784016),new w(o[26],2566594879),new w(o[27],3203337956),new w(o[28],1034457026),new w(o[29],2466948901),new w(o[30],3758326383),new w(o[31],168717936),new w(o[32],1188179964),new w(o[33],1546045734),new w(o[34],1522805485),new w(o[35],2643833823),new w(o[36],2343527390),new w(o[37],1014477480),new w(o[38],1206759142),new w(o[39],344077627),new w(o[40],1290863460),new w(o[41],3158454273),new w(o[42],3505952657),new w(o[43],106217008),new w(o[44],3606008344),new w(o[45],1432725776),new w(o[46],1467031594),new w(o[47],851169720),new w(o[48],3100823752),new w(o[49],1363258195),new w(o[50],3750685593),new w(o[51],3785050280),new w(o[52],3318307427),new w(o[53],3812723403),new w(o[54],2003034995),new w(o[55],3602036899),new w(o[56],1575990012),new w(o[57],1125592928),new w(o[58],2716904306),new w(o[59],442776044),new w(o[60],593698344),new w(o[61],3733110249),new w(o[62],2999351573),new w(o[63],3815920427),new w(3391569614,3928383900),new w(3515267271,566280711),new w(3940187606,3454069534),new w(4118630271,4000239992),new w(116418474,1914138554),new w(174292421,2731055270),new w(289380356,3203993006),new w(460393269,320620315),new w(685471733,587496836),new w(852142971,1086792851),new w(1017036298,365543100),new w(1126000580,2618297676),new w(1288033470,3409855158),new w(1501505948,4234509866),new w(1607167915,987167468),new w(1816402316,1246189591)];function ae(d){return d==="SHA-384"?[new w(3418070365,c[0]),new w(1654270250,c[1]),new w(2438529370,c[2]),new w(355462360,c[3]),new w(1731405415,c[4]),new w(41048885895,c[5]),new w(3675008525,c[6]),new w(1203062813,c[7])]:[new w(h[0],4089235720),new w(h[1],2227873595),new w(h[2],4271175723),new w(h[3],1595750129),new w(h[4],2917565137),new w(h[5],725511199),new w(h[6],4215389547),new w(h[7],327033209)]}function ce(d,s){var l,f,p,u,A,C,I,M,H,R,D,X,N,J,W,tt,nt=[];for(l=s[0],f=s[1],p=s[2],u=s[3],A=s[4],C=s[5],I=s[6],M=s[7],D=0;D<80;D+=1)D<16?(X=2*D,nt[D]=new w(d[X],d[X+1])):nt[D]=Z((N=nt[D-2],J=void 0,W=void 0,tt=void 0,J=ct(N,19),W=ct(N,61),tt=Y(N,6),new w(J.N^W.N^tt.N,J.I^W.I^tt.I)),nt[D-7],ue(nt[D-15]),nt[D-16]),H=st(M,Le(A),O(A,C,I),ke[D],nt[D]),R=U(V(l),k(l,f,p)),M=I,I=C,C=A,A=U(u,H),u=p,p=f,f=l,l=U(H,R);return s[0]=U(l,s[0]),s[1]=U(f,s[1]),s[2]=U(p,s[2]),s[3]=U(u,s[3]),s[4]=U(A,s[4]),s[5]=U(C,s[5]),s[6]=U(I,s[6]),s[7]=U(M,s[7]),s}var Oe=function(d){function s(l,f,p){var u=this;if(l!=="SHA-384"&&l!=="SHA-512")throw new Error(v);var A=p||{};return(u=d.call(this,l,f,p)||this).F=u.Y,u.g=!0,u.C=-1,u.p=r(u.t,u.i,u.C),u.R=ce,u.B=function(C){return C.slice()},u.L=ae,u.K=function(C,I,M,H){return function(R,D,X,N,J){for(var W,tt=31+(D+129>>>10<<5),nt=D+X;R.length<=tt;)R.push(0);for(R[D>>>5]|=128<<24-D%32,R[tt]=4294967295&nt,R[tt-1]=nt/4294967296|0,W=0;W<R.length;W+=32)N=ce(R.slice(W,W+32),N);return J==="SHA-384"?[(N=N)[0].N,N[0].I,N[1].N,N[1].I,N[2].N,N[2].I,N[3].N,N[3].I,N[4].N,N[4].I,N[5].N,N[5].I]:[N[0].N,N[0].I,N[1].N,N[1].I,N[2].N,N[2].I,N[3].N,N[3].I,N[4].N,N[4].I,N[5].N,N[5].I,N[6].N,N[6].I,N[7].N,N[7].I]}(C,I,M,H,l)},u.m=ae(l),u.S=1024,u.U=l==="SHA-384"?384:512,u.T=!1,A.hmacKey&&u.k(x("hmacKey",A.hmacKey,u.C)),u}return g(s,d),s}(b),He=[new w(0,1),new w(0,32898),new w(2147483648,32906),new w(2147483648,2147516416),new w(0,32907),new w(0,2147483649),new w(2147483648,2147516545),new w(2147483648,32777),new w(0,138),new w(0,136),new w(0,2147516425),new w(0,2147483658),new w(0,2147516555),new w(2147483648,139),new w(2147483648,32905),new w(2147483648,32771),new w(2147483648,32770),new w(2147483648,128),new w(0,32778),new w(2147483648,2147483658),new w(2147483648,2147516545),new w(2147483648,32896),new w(0,2147483649),new w(2147483648,2147516424)],Ke=[[0,36,3,41,18],[1,44,10,45,2],[62,6,43,15,61],[28,55,25,21,56],[27,20,39,8,14]];function zt(d){var s,l=[];for(s=0;s<5;s+=1)l[s]=[new w(0,0),new w(0,0),new w(0,0),new w(0,0),new w(0,0)];return l}function Ue(d){var s,l=[];for(s=0;s<5;s+=1)l[s]=d[s].slice();return l}function Dt(d,s){var l,f,p,u,A,C,I,M,H,R=[],D=[];if(d!==null)for(f=0;f<d.length;f+=2)s[(f>>>1)%5][(f>>>1)/5|0]=pt(s[(f>>>1)%5][(f>>>1)/5|0],new w(d[f+1],d[f]));for(l=0;l<24;l+=1){for(u=zt(),f=0;f<5;f+=1)R[f]=(A=s[f][0],C=s[f][1],I=s[f][2],M=s[f][3],H=s[f][4],new w(A.N^C.N^I.N^M.N^H.N,A.I^C.I^I.I^M.I^H.I));for(f=0;f<5;f+=1)D[f]=pt(R[(f+4)%5],Mt(R[(f+1)%5],1));for(f=0;f<5;f+=1)for(p=0;p<5;p+=1)s[f][p]=pt(s[f][p],D[f]);for(f=0;f<5;f+=1)for(p=0;p<5;p+=1)u[p][(2*f+3*p)%5]=Mt(s[f][p],Ke[f][p]);for(f=0;f<5;f+=1)for(p=0;p<5;p+=1)s[f][p]=pt(u[f][p],new w(~u[(f+1)%5][p].N&u[(f+2)%5][p].N,~u[(f+1)%5][p].I&u[(f+2)%5][p].I));s[0][0]=pt(s[0][0],He[l])}return s}function he(d){var s,l,f=0,p=[0,0],u=[4294967295&d,d/4294967296&2097151];for(s=6;s>=0;s--)(l=u[s>>2]>>>8*s&255)===0&&f===0||(p[f+1>>2]|=l<<8*(f+1),f+=1);return f=f!==0?f:1,p[0]|=f,{value:f+1>4?p:[p[0]],binLen:8+8*f}}function Xt(d){return E(he(d.binLen),d)}function le(d,s){var l,f=he(s),p=s>>>2,u=(p-(f=E(f,d)).value.length%p)%p;for(l=0;l<u;l++)f.value.push(0);return f.value}var Fe=function(d){function s(l,f,p){var u=this,A=6,C=0,I=p||{};if((u=d.call(this,l,f,p)||this).numRounds!==1){if(I.kmacKey||I.hmacKey)throw new Error("Cannot set numRounds with MAC");if(u.o==="CSHAKE128"||u.o==="CSHAKE256")throw new Error("Cannot set numRounds for CSHAKE variants")}switch(u.C=1,u.p=r(u.t,u.i,u.C),u.R=Dt,u.B=Ue,u.L=zt,u.m=zt(),u.T=!1,l){case"SHA3-224":u.S=C=1152,u.U=224,u.g=!0,u.F=u.Y;break;case"SHA3-256":u.S=C=1088,u.U=256,u.g=!0,u.F=u.Y;break;case"SHA3-384":u.S=C=832,u.U=384,u.g=!0,u.F=u.Y;break;case"SHA3-512":u.S=C=576,u.U=512,u.g=!0,u.F=u.Y;break;case"SHAKE128":A=31,u.S=C=1344,u.U=-1,u.T=!0,u.g=!1,u.F=null;break;case"SHAKE256":A=31,u.S=C=1088,u.U=-1,u.T=!0,u.g=!1,u.F=null;break;case"KMAC128":A=4,u.S=C=1344,u.M(p),u.U=-1,u.T=!0,u.g=!1,u.F=u.X;break;case"KMAC256":A=4,u.S=C=1088,u.M(p),u.U=-1,u.T=!0,u.g=!1,u.F=u.X;break;case"CSHAKE128":u.S=C=1344,A=u.O(p),u.U=-1,u.T=!0,u.g=!1,u.F=null;break;case"CSHAKE256":u.S=C=1088,A=u.O(p),u.U=-1,u.T=!0,u.g=!1,u.F=null;break;default:throw new Error(v)}return u.K=function(M,H,R,D,X){return function(N,J,W,tt,nt,vt,ut){var ft,$t,Lt=0,It=[],kt=nt>>>5,Pe=J>>>5;for(ft=0;ft<Pe&&J>=nt;ft+=kt)tt=Dt(N.slice(ft,ft+kt),tt),J-=nt;for(N=N.slice(ft),J%=nt;N.length<kt;)N.push(0);for(N[(ft=J>>>3)>>2]^=vt<<ft%4*8,N[kt-1]^=2147483648,tt=Dt(N,tt);32*It.length<ut&&($t=tt[Lt%5][Lt/5|0],It.push($t.I),!(32*It.length>=ut));)It.push($t.N),64*(Lt+=1)%nt==0&&(Dt(null,tt),Lt=0);return It}(M,H,0,D,C,A,X)},I.hmacKey&&u.k(x("hmacKey",I.hmacKey,u.C)),u}return g(s,d),s.prototype.O=function(l,f){var p=function(I){var M=I||{};return{funcName:x("funcName",M.funcName,1,{value:[],binLen:0}),customization:x("Customization",M.customization,1,{value:[],binLen:0})}}(l||{});f&&(p.funcName=f);var u=E(Xt(p.funcName),Xt(p.customization));if(p.customization.binLen!==0||p.funcName.binLen!==0){for(var A=le(u,this.S>>>3),C=0;C<A.length;C+=this.S>>>5)this.m=this.R(A.slice(C,C+(this.S>>>5)),this.m),this.v+=this.S;return 4}return 31},s.prototype.M=function(l){var f=function(A){var C=A||{};return{kmacKey:x("kmacKey",C.kmacKey,1),funcName:{value:[1128353099],binLen:32},customization:x("Customization",C.customization,1,{value:[],binLen:0})}}(l||{});this.O(l,f.funcName);for(var p=le(Xt(f.kmacKey),this.S>>>3),u=0;u<p.length;u+=this.S>>>5)this.m=this.R(p.slice(u,u+(this.S>>>5)),this.m),this.v+=this.S;this.A=!0},s.prototype.X=function(l){var f=E({value:this.u.slice(),binLen:this.s},function(p){var u,A,C=0,I=[0,0],M=[4294967295&p,p/4294967296&2097151];for(u=6;u>=0;u--)(A=M[u>>2]>>>8*u&255)==0&&C===0||(I[C>>2]|=A<<8*C,C+=1);return I[(C=C!==0?C:1)>>2]|=C<<8*C,{value:C+1>4?I:[I[0]],binLen:8+8*C}}(l.outputLen));return this.K(f.value,f.binLen,this.v,this.B(this.m),l.outputLen)},s}(b);return function(){function d(s,l,f){if(s=="SHA-1")this.j=new Yt(s,l,f);else if(s=="SHA-224"||s=="SHA-256")this.j=new Et(s,l,f);else if(s=="SHA-384"||s=="SHA-512")this.j=new Oe(s,l,f);else{if(s!="SHA3-224"&&s!="SHA3-256"&&s!="SHA3-384"&&s!="SHA3-512"&&s!="SHAKE128"&&s!="SHAKE256"&&s!="CSHAKE128"&&s!="CSHAKE256"&&s!="KMAC128"&&s!="KMAC256")throw new Error(v);this.j=new Fe(s,l,f)}}return d.prototype.update=function(s){this.j.update(s)},d.prototype.getHash=function(s,l){return this.j.getHash(s,l)},d.prototype.setHMACKey=function(s,l,f){this.j.setHMACKey(s,l,f)},d.prototype.getHMAC=function(s,l){return this.j.getHMAC(s,l)},d}()})})(Me);let Ft=Me.exports;Ft.default&&(Ft=Ft.default);var On=function(t,e){e=e||{};let n,r,i,o,c,h;return e.period=e.period||30,e.algorithm=e.algorithm||"SHA-1",e.digits=e.digits||6,e.timestamp=e.timestamp||Date.now(),t=Kn(t),n=Math.round(e.timestamp/1e3),r=re(Hn(Math.floor(n/e.period)),16,"0"),i=new Ft(e.algorithm,"HEX"),i.setHMACKey(t,"HEX"),i.update(r),o=i.getHMAC("HEX"),c=Qt(o.substring(o.length-1)),h=(Qt(o.substr(c*2,8))&Qt("7fffffff"))+"",h=h.substr(Math.max(h.length-e.digits,0),e.digits),h};function Qt(a){return parseInt(a,16)}function Hn(a){return(a<15.5?"0":"")+Math.round(a).toString(16)}function Kn(a){let t="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",e="",n="";a=a.replace(/=+$/,"");for(let r=0;r<a.length;r++){let i=t.indexOf(a.charAt(r).toUpperCase());if(i===-1)throw new Error("Invalid base32 character in key");e+=re(i.toString(2),5,"0")}for(let r=0;r+8<=e.length;r+=8){let i=e.substr(r,8);n=n+re(parseInt(i,2).toString(16),2,"0")}return n}function re(a,t,e){return t+1>=a.length&&(a=Array(t+1-a.length).join(e)+a),a}const De="23456789BCDFGHJKMNPQRTVWXY",Se=De.length;function Un(a,t=!1){let e=On(a,{digits:t?10:6});if(!t)return e;const n=[];for(let r=0;r<5;r++){const i=e%Se;n.push(De[i]),e=Math.trunc(e/Se)}return n.join("")}const Fn={key:0},Pn=["onClick"],qn={__name:"code",setup(a){Xe(()=>$e.emitChanged());const t=mt(!1),e=mt(!1),n=mt([]),r=mt(""),i=mt(30),o=()=>x.value.forEach(b=>b.code=Un(b.key,b.type=="steam")),c=b=>fn.copy(String(b)),h=mt(null);Ze("data",null,{prefix:"./",return:"raw"}).then(b=>setTimeout(()=>h.value=b,1e4));const v=mt(!1),E=async b=>{v.value=!1,n.value=JSON.parse(kn(b,r.value)).sort((S,g)=>S.issuer.localeCompare(g.issuer)),t.value=!0,o(),setInterval(()=>{(i.value=30-new Date().getSeconds()%30)==30&&o()},1e3),document.addEventListener("visibilitychange",o)},B=async()=>{if(v.value=!0,h.value)return E(h.value);const b=Ct(h,S=>b(E(S)))},x=wt(()=>n.value.filter(b=>!(~~e.value^~~b.tags.includes("\u6210\u4EBA"))));return Ct(e,o),(b,S)=>{const g=en("tip");return St(),Tt("module",null,[t.value?(St(),Tt(de,{key:1},[yt("p-prog",null,[yt("p-prog-value",{style:_t({width:`${(i.value-1)/29*100}%`})},null,4)]),yt("p-coder-list",{onClick:S[1]||(S[1]=tn(m=>e.value=!e.value,["ctrl","self"]))},[(St(!0),Tt(de,null,Qe(ot(x),m=>(St(),Tt("p-coder",{key:`code-${m.key}`},[Ae((St(),Tt("p-title",null,[Ge(Kt(m.issuer)+" ("+Kt(m.user)+")",1)])),[[g,m.user]]),yt("p-code-box",{onClick:T=>c(m.code)},[yt("p-code",null,Kt(m.code),1),yt("p-code-icon",null,[Zt(ot(_e),{icon:ot(hn)},null,8,["icon"])])],8,Pn)]))),128))])],64)):(St(),Tt("p-login-box",Fn,[yt("p-login",null,[Zt(ot(cn),{modelValue:r.value,"onUpdate:modelValue":S[0]||(S[0]=m=>r.value=m),password:"",type:"pass",place:"\u8BBF\u95EE\u5BC6\u7801",onKeypress:We(B,["enter"])},null,8,["modelValue","onKeypress"]),Zt(ot(Je),{preaccess:"",text:"\u8BBF\u95EE",icon:v.value?ot(ln):null,spin:v.value,onClick:B},null,8,["icon","spin"])])]))])}}},Yn=Te(qn,[["__scopeId","data-v-f5a40cff"]]);export{Yn as default};
